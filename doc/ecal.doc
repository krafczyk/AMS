    Classes :
//
class AMSEcalMCHit: public AMSlink{
protected:
 integer  _idsoft;// SSLLFFF (SS->s-layer,LL->f-layer in SS, FFF->fiber in LL)
 AMSPoint _xcoo;
 number _tof;
 number _edep;

public:
 
 AMSEcalMCHit(integer idsoft,AMSPoint xcoo,number edep, number tof) :
 _idsoft(idsoft), _xcoo(xcoo),_edep(edep),_tof(tof){_next=0;};
 AMSEcalMCHit(){_next=0;};
 ~AMSEcalMCHit(){};
 void _printEl(ostream &stream){stream <<"AMSEcalMCHit "<<_idsoft<<" "<<_edep<<endl;}
 void _writeEl();
 void _copyEl(){};
 static void siecalhits(integer idsoft , geant vect[],geant edep, geant tofg);
 AMSEcalMCHit *  next(){return (AMSEcalMCHit*)_next;}
 integer operator < (AMSlink & o)const{
 return _idsoft < ((AMSEcalMCHit*)(&o)) ->_idsoft;}

 integer getid() const {return _idsoft;}
 number getedep() const {return _edep;}
 number gettime() const {return _tof;}
 number getcoo(integer i) {return i>=0 && i<3 ? _xcoo[i]:0;}
// static integer Out(integer);

//#ifdef __DB__
//   friend class AMSEcalMCHitD;
//#endif
};
//----------------------------------------------
class AMSEcalRawEvent: public AMSlink{
private:
  integer _idsoft; //readout cell ID=SSPPC (SS->S-layer,PP->PMcell, C->SubCell in PMcell)
//integer _status; // status (0/1/... -> alive/dead/...) (It is really in AMSlink !!!)
  integer _padc;// Pulse hight (ADC-channels)
public:
  AMSEcalRawEvent(integer idsoft, integer status,  
        integer padc):AMSlink(status,0),_idsoft(idsoft),_padc(padc)
  {};
  ~AMSEcalRawEvent(){};
  AMSEcalRawEvent * next(){return (AMSEcalRawEvent*)_next;}
//
  integer operator < (AMSlink & o)const{
                return _idsoft<((AMSEcalRawEvent*)(&o))->_idsoft;}
//
  integer getid() const {return _idsoft;}
  integer getpadc(){return _padc;}
//
  static void mc_build(int &stat);
  static void validate(int &stat);
//
//-----------------------------------
class AMSEcalHit: public AMSlink{
private:
//integer _status; // status (0/1/... -> alive/dead/...) (It is really in AMSlink !!!)
  integer _proj;   //projection (0->X, 1->Y)
  integer _plane;  //continious numbering of planes through 2 projections(0,...)
  integer _cell;   // numbering in plane(0,...)
  number  _edep;
  number  _coot;   //transv.coord.
  number  _cool;   //long.coord.
  number  _cooz;
public:
  AMSEcalHit(integer status, integer proj, integer plane, integer cell,number edep,
         number coot, number cool, number cooz):AMSlink(status,0),_proj(proj),
	 _plane(plane),_cell(cell),_edep(edep),_coot(coot),_cool(cool),_cooz(cooz){};
  ~AMSEcalHit(){};
  AMSEcalHit * next(){return (AMSEcalHit*)_next;}
//
  integer getproj(){return _proj;}
  integer getplane(){return _plane;}
  integer getcell(){return _cell;}
  number getedep(){return _edep;}
  number getcoot(){return _coot;}
  number getcool(){return _cool;}
  number getcooz(){return _cooz;}
//
  static void build(int &stat);
//
class AMSEcalCluster: public AMSlink{ // 1-D cluster
private:
//integer _status; // status (0/1/... -> alive/dead/...) (It is really in AMSlink !!!)
  integer _proj;   //projection (0->X, 1->Y)
  integer _plane;  //continious numbering of planes through 2 projections(0,...)
  number  _edep;
  AMSPoint _Coo;  // cluster center of gravity coordinates (cm)
  AMSPoint _ErrorCoo; // Error to coordinates
  integer _nmemb; // number of EcalHit members
  AMSEcalHit * _mptr[2*ECPMSMX]; // list of pointers to member
public:
  AMSEcalCluster(integer status, integer proj, integer pl, number edep, AMSPoint coo,
     AMSPoint ecoo, integer nm, AMSEcalHit *ptr[]): AMSlink(status,0),_proj(proj),
		        _plane(pl),_edep(edep),_Coo(coo),_ErrorCoo(ecoo),_nmemb(nm){
    for(int i=0;i<nm;i++)_mptr[i]=ptr[i];
  };
  ~AMSEcalCluster(){};
  AMSEcalCluster * next(){return (AMSEcalCluster*)_next;}
//
  integer getproj(){return _proj;}
  integer getplane(){return _plane;}
  number getedep(){return _edep;}
  AMSPoint getcoo()const {return _Coo;}
  AMSPoint getecoo()const {return _ErrorCoo;}
  integer getmemb(AMSEcalHit *ptr[]){
    for(int i=0;i<_nmemb;i++)ptr[i]=_mptr[i];
    return _nmemb;
  }
//
  static void build(int &stat);
  static integer Out(integer);
  static void init();
//
protected:
  void _printEl(ostream &stream){
    int i;
    stream <<"AMSEcalCluster: Proj= "<<_proj<<" plane="<<_plane<<endl;
    stream <<"Status="<<hex<<_status<<"  Edep="<<dec<<_edep<<endl; 
    stream <<"Coord="<<_Coo[0]<<" "<<_Coo[1]<<" "<<_Coo[2]<<"  ErrCoo="<<_ErrorCoo<<endl;
    stream <<"Nmembers="<<_nmemb<<endl;
    stream <<dec<<endl<<endl;
  }
void _writeEl();
void _copyEl();
//
};
