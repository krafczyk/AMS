Datacards

//General 
          
AMSJOB  
I 1  Jobtype(0)      // 1 - Reconstruction ( 0 Simulation)
                     // 10 - Real Data
                     // 100 - Tracker Calibration 
                     // 200 - TOF Calibration 
                     // 300 - Anti Calibration 
                     // 400 - Cerenkov Calibration 
                     // 500 - Magnet Calibration 
                     // 600 - RICH Calibration 
                     // 700 - TRD Calibration 
                     // 800 - TAMS Calibration 
                     // 900 - Reserved
                     // 
I 2  Debug(1)        // 0 - Off   ; 1 - On
R 3  CpuLimit(10.)   // CpuLimit in native sec per event
I 4  Read(0)         // 0 - Off   ; 1 - setup 10 -Mceventg 100 -mc banks
                     // 1000 - Rec banks
I 5  Write(0)        // Same as for read  
I 6  Jobname(160*' ')// Jobname == list in db (<160 bytes)
I46  Setupname(160*' ')  // Setupname == Setup Name (<160 bytes)
                     // see setup.doc for details
I86  ZeroSetupOK(0)  // Internal
I87  Update(0)       // Update(1) or not(0) TDV in DBase
I88  TDVC(1600*' ')  // TDV Names, separated by |, which will be updated
                     // if Update(see above) ==1
//IO

IOPA 
I 1    hlun(0)                   // 0 - Noutput ; >0 - Lun
I 2    hfile(160*' ')            // Output file name
I42    ntupleId(1)               // Ntuple Id
I43    WriteAll(0)               // Flag to write all or  "used only" objects
I44    TriggerI(1)               // Not used in v204++
I45    TriggerC('AMSParticle')   // Container names, separated by
                                 // & or | to trigger write 
                                 // the ntuple and/or db
I85    mode(0)                   // simple i/0 mode switch
                                 // 0 - nothing 1 -read 2 - write 3 - append
I86   ffile(' ')                 // file name

//Anti Simulation

ANTIMC
R 1   SigmaPed(1.)        // Noise sigma in p.e.
R 2   GeV2PhEl(20e3)      // conversion gev ->p.e. 
R 3   LZero(120.)         // saturation length in cm

//Anti Reconstruction


ANTIREC
R 1 ThrS(5)               // Threshold in p.e. on up+down hits
R 2 PhEl2MeV(0.05)        // Conversion p.e. -> mev


// TOF  Simulation

TOFMC      
R  1   TimeSigma(110e-12)  // Time resolution(sec) for simplified(fast) algorithm 
R  2   TimeSigma2(450e-12)  // 2nd Time res(sec) for simplified algorithm 
R  3   TimeProbability2(0.035)  // 2nd Time Probability
R  4   padl(10.5)          // Sc. bars transv. step (cm) ..................
R  5   Thr(0.1)            // Sc.bar Elos-thresh(mev) to participate in Reco 
I  6   Print-flag(0)       // to print init arrays if=1        
I  7   Print-flag(0)       // to print PMT pulses if=1        
I  8   Print-flag(0)       // to print MC-histograms if=1        
I  9   Print-flag(0)       // spare        
I 10   Print-flag(0)       // spare
I 11   Trig.logic-flag(0)  //  use AND/OR(if=0/1) for two side logic signals   
I 12   Trig.logic-flag(0)  //  use ANY3/ALL4(if=0/1) coinc. for 4 TOF-layers         
I 13   fast(1)             //  fast/slow(i.e. accurate) (1/0) algorithm switch
I 14   daqfmt(1)           // Raw/Reduced(0/1) TDC format for DAQ simulation
I 15-17  file-name         // (<=11 letters) contains map of t-distr. file names


// TOF Reconstruction

TOFREC
R 1   Thresh(0.45)        // Thresh(mev) on "peak" bar Elos in clustering procedure
R 2   Thresh(0.9)         // Thresh(mev) on total cluster energy ...................
I 3   Print-flag(0)       // spare
I 4   Print-flag(0)       // spare
I 5   Print-flag(0)       // print RECO-histograms (if=1)
I 6   Print-flag(0)       // spare
I 7   Print-flag(0)       // spare
I 8   RECO logic-flag(0)  // Normal/TZSL/AMPL/Stretch_ratio-calibr_run(if=0/1/2/3)
I 9   RECO logic-flag(0)  // spare
I 10  RECO logic-flag(0)  // spare
I 11  RECO logic-flag(0)  // spare
I 12  RECO logic-flag(0)  // spare
I 13-15 generic file-name // (<=11 letters) contains bar-types map and geometry const.
I 16  DAQ-thresh-1 (40)     // thresh.(mv) for fast t-discriminator (z>=1 trig)
I 17  DAQ-thresh-2 (100)    // thresh.(mv) for z>1-trig. discr.
I 18  DAQ-thresh-3 (200)    // thresh.(mv) for z>2-trig. discr.
I 19  DAQ-thresh-4 (10)     // thresh.(pC) for anode Time_over_Threshold discr.
I 20  DAQ-thresh-5 (10)     // thresh.(pC) for dinode Time_over_Threshold discr.
I 21  cut-1 ()            // cut on time diff. of the same hit in fast/slow TDC
I 22  cut-2 ()            // cut on min. distance of "befor"-hit in time history TDC
I 23  cut-3 ()            // ........................"after"-hit in time history TDC
I 24-30 spare cuts        //
I 31   sec[2](0,0)        // Validity time:
I 33   min[2](0,0)        //
I 35   hour[2](0,0)       // 
I 37   day[2](1,1)        //
I 39   mon[2](0,0)        //
I 41   year[2](96,98)     //

// TOF calibration

TOFCA
R  1 plow(8.);  // track mom. low limit (gev/c)
R  2 phigh(50.);// track mom. high limit
R  3 meanbeta(0.996);// mean proton velocity in this range 
R  4 T0-ref1(6.);   // T0 for ref. counters
R  5 T0-ref2(6.);   // T0 for ref. counters
R  6 slope(3.2);    // def. slope
R  7 invstr(0.025); // def. inv. stratcher ratio
I  8 id-ref1(108);  // LBB for first ref. counter (if non zero)
I  9 id-ref2(0);    // LBB for second ref. counter (if nonzero)
I 10 fix-slope(1); // =0/1 to fix/release slope param.
I 11 fix-invstr(0);// =0/1 to fix/release str.ratio param.
//---------------------------------------------------------------------------------

// CTC  Simulation

CTCGEOM
R  1   wallth(0.03)             // reflecting wall(separators) thickness(cm)
R  2   agap(0.02)               // typical "air" gaps
R  3   wgap(0.01)               // typical wls gaps
R  4   agsize[3]{120.,90.,10.}  // max aerogel x-size
R  7   wlsth(0.3)               // WLS thickness
R  8   hcsize[3]{165.,165.,5.}  // supp. honeycomb plate X-size
R 11   supzc(-84.)              // supp. honeycomb plate front face Z-pos
R 12   aegden(0.24)             // aerogel density
R 13   wlsden(1.03)             // WLS density
I 14   nblk(12)                 // number of aer. blocks (X-div.)
I 15   nwls(12)                 // number of wls  blocks (X-div.)

CTCMC      
R  1   Refraction[2](1.055,1.59) // Refraction indexes
R  3   Path2PhEl(23.,28.)        // Path to photoelectrons conv factor
R  5   AbsLengt(15, 100)         // Abs length in cm 
R  7   Edep2Phel(0,184e3)       //  Edep to phelectrons conv factor



// Tracker Cluster  Simulation

TRMC      
R 1   alpha(220)            // Cluster shower par (see tkmccl.F)
R 2   beta(1.0)               // Cluster shower par (see tkmccl.F)
R 3   gamma(0.08)           // Cluster shower par (see shower in mccluster.C)
R 4   fastswitch(5.e-5)     // Switch between fast and slow algos
R 5   dedx2nprel(.33e6)     // dedx to number of primary electrons
R 6   ped[2](100,100)       // pedestals for x & y
R 8   sigma[2](4.2,3.)      // noise for x & y
R10   gain[2](8,8)          // gains for x & y
R12   cmn[2](50,50)         // common noise for x & y
I14   adcoverflow(32767)    // 16 bit adc
I15   NoiseOn(1)            // Generate(1) do not generate(0) noise in tracker
I16   sec[2](0,0)           // 
I18   min[2](0,0)           //
I20   hour[2](0,0)          // Validity time
I22   day[2](1,1)           //
I24   mon[2](0,0)           //
I26   year[2](96,98)        //
I28   CalcCmnNoise[2])(0,3) // Calc(1=1 or not 1=0 cmnnoise properly)
R30   thr1R[2](4.5,4.5)     // threshold (S/N) to save cluster
R32   thr2R[2](1.,1.)       // threshold (S/N) to save hits in cluster
I34   neib[2](2,2)          // number of neibours from one side
I36   GenerateConst(0)      // generate/not generate tracker const

// MC particle generation

MCGEN
R 1 coo[2][3](3*-1.e10,3*1.e10)   //make the cube surface the particle 
                                  //originate from
R 7 dir[2][3](3*-1.,3*1.)         //Particle Directions range
R13 momr[2](-1.e10,1.e10)         //Particle momentum range
I15 fixp(0)                       //fix the cube surface for particle 
                                  //generation 1 - top, 2-bottom,
                                  //3,4,5,6 - others
R16 albedorate(0.01)              //assumed albedo relative rate
R17 albedocz(0.05)                //assumed min cos(theta) for albedo 
I18 npat(1)                       //number of particle to generate in one go
I19 run(100)                      //run number
I20 low(0)                        //normal(0) or low(1) spectrum if ipart=3
I21 earth(1)                      // Earth magnetic field modulation on (1) off(0)
R22 theta(51.65)                  //Station Theta(deg) at begin
R23 phi(290.)                     //Station Phi(deg) at begin
R24 pole(290.)                    // Pole phi at begin 
I25 begindate(22051998)           // start date (ddmmyyyy)
I26 begintime(080000)             // start time (hhmmss)
I27 enddate(26051998)             // end date   (ddmmyyyy)
I28 endtime(120000)               // end time   (hhmmss)
I29 dir(1)                        // direction +1 to higher theta (-1 to lower)
I30 oldformat(0)                  // 1 if oldformat for io read is used

KINE 
1 IPART        // Geant particle id

RNDM
1 nrndm1      // initial random seed1
2 nrmdm2      // initial random seed2


// CTC  Reconstruction

CTCREC      
R 1   Thr1(1.5)                   // Threshold on max element of cluster (phe)
R 2   ThrS(3.)                   // Threshold on  cluster sum (phe)

// Tracker Clusters Reconstruction

TRCL
R 1 ThrClA[2](45,45)    // Lower limit for amplitude for cls (x,y)
R 3 ThrClS[2](14,10)    // Upper limit for sigma     for cls (x,y)
R 5 ThrClR[2](7,8)    // Lower limit for Amplitude/sigma for cls (x,y)
R 7 Thr1A[2](30,25)     // Lower limit for ampl for max hit in cluster
R 9 Thr1S[2](10,7)       // Upper limit for sigma for max hit in cluster
R11 Thr1R[2](6,5)       // Lower limit for a/sigma for max hit in cluster
R13 Thr2A[2](6,7)      // Lower limit for ampl for other hits in cluster 
R15 Thr2S[2](10,7)       // Upper limit for sigma for other hits in cluster 
R17 Thr2R[2](1.,1.)   // Lower limit for a/sigma for other  hits in cluster
R19 Thr3R[2](-2.,-2.)   // Reserved
I21 ThrClNMin[2](1,2)   // Min Number of hits satisfied the above limits
I23 ThrClNEl[2](3,3)    // total number hits in the cluster
R25 ThrDSide(1)         // Upper threshold to (A_x-A_y)/(A_x+A_y)
R26 ErrX(30e-4)         // Assumed Error in X dir
R27 ErrY(10e-4)         // Assumed Error in Y dir
R28 ErrZ(30e-4)         // Assumed Error in Z dir
R29 CorFunParA[2][6](400.e-4,65e-4)
                        // 1st Parameter of correction fun for
                        // border clusters cofg calculation          
                        // 1st index side(x,y); 2nd - layer
R41 CorFunParB[2][6](0.85,0.5)
                        // 2nd parameter
                        // corr function is of 
                        // 0 if s1/st < ParB;
                        // ParA*atan(s1/st-ParB) otherwise
R53 ResFunX[3][6];      //  Parabolic parametrization of resolution
R71 ResFunX[3][6];      //

// Tracker pattern recognition
TRFIT
I 1 Pattern[22](5*1,17*0)
  //    Number              Descr             Points      Default
  //    0                   123456            6           on
  //    1                   12346             5           on
  //    2                   12356             5           on
  //    3                   12456             5           on
  //    4                   13456             5           on
  //    5                   12345             5           off
  //    6                   23456             5           off
  //    7                   1234              4           off
  //    8                   1235              4           off
  //    9                   1236              4           off
  //   10                   1245              4           off
  //   11                   1246              4           off
  //   12                   1256              4           off
  //   13                   1345              4           off
  //   14                   1346              4           off
  //   15                   1356              4           off
  //   16                   1456              4           off
  //   17                   2345              4           off
  //   18                   2346              4           off
  //   19                   2356              4           off
  //   20                   2456              4           off
  //   21                   3456              4           off
I23  UseTOF(1)                    // Use(>=1 == Min No TOF clusters matched)/
                                  // Not use(0) TOF  for pattern No 16
R24  Chi2FastFit(20)              // Max  chi2 for tkhmd;
R25  Chi2StrLine(20)              // The same for Straight line fit
R26  Chi2Circle(20)         // The same for Circle fit
R27  ResCutFastFit(0.5)     // Max residual distance in cm between 
                                  // point and fitted curve (not yet impl)
R28  ResCutStrLine(0.5)     // --- strline    (not yet impl)
R29  ResCutCircle(0.5)      // --- circlefit  (not yet impl)
R30  SearchRegFastFit(1)    // Max distance in cm between point 
                                  // and extrarpolated curve to include
                                  // point in the pattern
R31  SearchRegStrLine(0.5)  // ------- strline fit
R32  SearchRegCircle(1)     // ---------- circle fit
R33  RidgidityMin(0.2)      // Minimal ridgidity in GV     
I34  FullReco(0)            // Use(1) or not use(0) "used "clusters to build 
                            // tracks
R35  MinRefitCos(0.7,0.5)      // min cos(tr angle) to refit track with wider
                            // clusters
I36  FastTracking(0)        // Make(1) do not make(0) nonlinear fitting



// Tracker fitting

TKFIT
R 1 tmaxf(0.2)    // max angle for grkuta   
R 2 smax(50)      // max step for grkuta
R 3 fieldm(2)     // max fiels (in kg) for grkuta 
R 4 cconv(5.e-4)  // conv parameter
I 5 maxcal(8)     // internal
I 6 nitm(1000)    // internal
R 7 xtol(1.e-2)   // internal
I 8 iver(0)       // internal
I 9 ialg(1)       // reserved
R10 steps(0.03)   // internal
I11 npars(5)      // internal
I12 ims(1)        // 0 -Multiple scattering accounting off; 1 - on  



// AMS Global Reconstruction

BETAFIT
I 1 Pattern[9](5*1,4*0)
  //    Number              Descr             Points      Default
  //    0                   1234              4           on
  //    1                   123               3           on
  //    2                   124               3           on
  //    3                   134               3           on
  //    4                   234               3           on
  //    5                   13                2           off
  //    6                   14                2           off
  //    7                   23                2           off
  //    8                   24                2           off
R10 Chi2(10.)       //  Max acceptable chi2 for betafit
R11 SearchReg[3](3.,3.,3.) // Max distance between track & tof hit in sigma's
                           // Used also in TOF-track matching for pat # 16

CHARGEFIT
R 1 Thr(1.)   // Refit charge if Fisher's criterium is satisfied(1.=67%,2.=95%)


TRCALIB    // trcaker calibration

I 1 EventsPerIteration[2](100,100)    // Events in one bunch
I 3 NumberOfIterations[2](200,200)    // number of bunches
R 5 BetaCut[2][2](0.7,10.,1.,10.)    // Beta limits
R 9 HitsRatioCut[2](2.5,2.5)          // Hit Ratio Limits
R11 MomentumCut[2][2](-inf,inf,3,inf) // momentum ----------
R15 Chi2Cut[2](3.,3.)                 // chi2 ---------------
R17 InitialCoo[6][3](0)               // Coordinates displacement
R35 InitialRM[6][3][3](0)             // Rot Matrix --------
};



LVL1    // LVL1 Trigger 

I 1 ntof(3)                           // min number of tof planes in trig
I 2 nanti(2)                         // max number of anti counters in trig



L3SIM

R 1 NoiseProbX(3.3e-4)                  // Noise Probability for x side
R 2 NoiseProbY(2.0e-4)                  // Noise Probability for y side


L3REC    // LVL3 Trigger Rec

I 1 MinTOFPlanesFired(3)               // min number of tof planes in trig
I 2 UseTightTOF(1)                     // Use(1) notUse(0) "Pattern" trigger
R 3 TrTOFSearchReg(6)                  // Road width to match TOF/Tracker (cm)
R 4 TrMinResidual(0.03)                // Min Residual to keep event (cm)
R 5 TrMaxResidual[3](0.9,0.1,0.2)     // Max Residuals to keep event (cm)
I 8 TrMaxHits(20)                      // Max Number of hits in Tracker
R 9 Splitting(0.04)                    // Min distance between hits
I10 Nrep(1)                            // Aux no of rep to calc lvl3 time
I11 Accept(0)                        // Min value of lvl3 trigger to accept


L3EXP   // LVL3 Expert 

I 1 NEvents(1024)                       // Number of Events in Sequence 
I 2 ToBad(3)                            // Number of conseq sequences to declare bad
I 3 TryAgain(10)                        // Number of sequences to unlock bad
R 4 Range[3][2](3,3,100000,3,3,3)       // Bad Range in sigmas



SELECT   // Choose run & event

I 1 run number                      // Run number
I 2 event(position) number          // Event (if > 0) Position(<0)





DAQC    //   DAQ Control

I 1 mode(0)                         // 0 do nothing
                                    // mode%10 = 1 read daq if isReconstruction()
                                    // mode/10 = 1 write daq (noreplace)
                                    // mode/10 = 2 write daq (append)
I 2 ifile[40]("")                   // input file name
I42 ofile[40]("")                   // output file name
