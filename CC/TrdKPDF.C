#include "TrdKPDF.h"

ClassImp(TrdKPDF)

void TrdKPDF::Init_Proton(){


    Double_t _mom[50]   = {0.50,  1.50,  2.50,  3.50,  4.50,  5.50,  6.50,  7.50,  8.40,  9.40,
                           10.9,  12.8,  14.7,  16.6,  18.5,  21.4,  25.0,  29.0,  33.0,  37.0,
                           41.5,  49.5,  57.5,  65.5,  73.5,  83.0,  99.0,  115.,  131.,  147.,
                           168.,  208.,  248.,  288.,  328.,  440.,  540.,  640.,  740.,  840.,
                           1000., 1500., 2000., 2500., 3000., 3500., 4000., 4500., 5000., 5500.};

    Double_t _p01_m[50] = {0.814, 0.810, 0.808, 0.806, 0.805, 0.804, 0.803, 0.802, 0.801, 0.800,
                           0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800,
                           0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800,
                           0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800,
                           0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800, 0.800};

    Double_t _p02_m[50] = {65.00, 59.00, 54.30, 56.40, 60.00, 63.00, 65.80, 68.50, 70.60, 72.70,
                           75.00, 77.90, 80.30, 82.40, 84.20, 86.20, 88.50, 90.40, 92.30, 93.80,
                           95.30, 97.40, 98.90, 99.90, 101.0, 102.3, 103.6, 104.2, 104.9, 105.5,
                           106.2, 107.2, 107.9, 108.5, 109.1, 110.1, 110.8, 111.3, 111.7, 112.1,
                           112.1, 112.1, 112.1, 112.1, 112.1, 112.1, 112.1, 112.1, 112.1, 112.1};

    Double_t _p03_m[50] = {80.00, 72.30, 61.86, 60.31, 60.43, 60.93, 61.49, 61.99, 62.50, 62.87,
                           63.57, 64.42, 65.11, 65.66, 66.22, 66.92, 67.79, 68.54, 69.07, 69.54,
                           70.31, 71.92, 71.70, 72.23, 72.82, 73.33, 73.94, 74.55, 75.23, 75.90,
                           76.50, 77.00, 77.40, 77.80, 78.10, 78.40, 78.60, 78.80, 78.90, 79.00,
                           79.00, 79.00, 79.00, 79.00, 79.00, 79.00, 79.00, 79.00, 79.00, 79.00};

    Double_t _p04_m[50] = {0.331, 0.335, 0.339, 0.343, 0.347, 0.351, 0.355, 0.359, 0.363, 0.367,
                           0.371, 0.375, 0.379, 0.383, 0.387, 0.391, 0.395, 0.399, 0.403, 0.407,
                           0.411, 0.415, 0.419, 0.423, 0.427, 0.431, 0.435, 0.438, 0.441, 0.444,
                           0.446, 0.448, 0.449, 0.450, 0.450, 0.450, 0.450, 0.450, 0.450, 0.450,
                           0.450, 0.450, 0.450, 0.450, 0.450, 0.450, 0.450, 0.450, 0.450, 0.450};

    Double_t _p05_m[50] = {0.045, 0.038, 0.033, 0.032, 0.032, 0.032, 0.032, 0.032, 0.032, 0.032,
                           0.032, 0.032, 0.032, 0.032, 0.033, 0.033, 0.033, 0.033, 0.034, 0.034,
                           0.034, 0.034, 0.034, 0.034, 0.034, 0.034, 0.035, 0.035, 0.035, 0.035,
                           0.035, 0.035, 0.035, 0.035, 0.035, 0.035, 0.035, 0.035, 0.035, 0.035,
                           0.035, 0.035, 0.035, 0.035, 0.035, 0.035, 0.035, 0.035, 0.035, 0.035};

    Double_t _p06_m[50] = {360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0,
                           360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0,
                           360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0,
                           360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0,
                           360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0, 360.0};

    Double_t _p07_m[50] = {640.0, 630.0, 624.0, 619.0, 614.2, 610.1, 606.2, 603.0, 600.0, 597.0,
                           595.0, 594.0, 592.5, 592.3, 592.1, 592.0, 591.7, 591.4, 591.1, 590.7,
                           590.2, 589.7, 589.3, 588.8, 588.3, 588.0, 587.3, 586.7, 586.2, 585.6,
                           585.2, 584.6, 583.2, 582.3, 581.7, 580.4, 580.0, 580.0, 580.0, 580.0,
                           580.0, 580.0, 580.0, 580.0, 580.0, 580.0, 580.0, 580.0, 580.0, 580.0};

    Double_t _p08_m[50] = {0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300,
                           0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300,
                           0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300,
                           0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300,
                           0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300};

    Double_t _p09_m[50] = {146.0, 136.0, 130.0, 130.0, 131.0, 131.7, 133.7, 137.3, 140.0, 142.7,
                           145.4, 148.1, 150.8, 153.5, 156.3, 160.2, 165.9, 171.6, 177.3, 183.0,
                           188.7, 194.4, 200.1, 205.8, 211.5, 217.2, 222.9, 228.6, 234.3, 240.0,
                           245.7, 251.4, 256.1, 260.0, 260.0, 260.0, 260.0, 260.0, 260.0, 260.0};

    Double_t _p10_m[50] = {240.0, 218.0, 198.0, 193.2, 193.2, 193.2, 193.2, 193.2, 193.2, 193.2,
                           193.2, 193.2, 193.2, 193.2, 193.2, 193.2, 193.4, 193.6, 193.8, 194.0,
                           194.4, 195.0, 195.8, 196.8, 199.8, 200.8, 202.0, 203.2, 204.6, 206.0,
                           207.2, 208.2, 209.0, 209.6, 210.0, 210.0, 210.0, 210.0, 210.0, 210.0,
                           210.0, 210.0, 210.0, 210.0, 210.0, 210.0, 210.0, 210.0, 210.0, 210.0};

    Double_t _p11_m[50] = {0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300,
                           0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300,
                           0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300,
                           0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300,
                           0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300};

    Double_t _p12_m[50] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.028, 0.056, 0.084, 0.112, 0.140,
                           0.182, 0.312, 0.385, 0.410, 0.422, 0.430, 0.436, 0.442, 0.448, 0.454};

    Double_t _p13_m[50] = {480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0,
                           480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0,
                           480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0,
                           480.0, 480.0, 480.0, 480.0, 482.0, 486.0, 491.0, 496.0, 501.0, 506.0,
                           512.0, 516.0, 520.0, 520.0, 520.0, 520.0, 520.0, 520.0, 520.0, 520.0};

    Double_t _p14_m[50] = {200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0,
                           200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0,
                           200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0,
                           200.0, 200.0, 200.0, 200.0, 218.0, 236.0, 253.0, 270.0, 287.0, 304.0,
                           326.0, 386.0, 418.0, 430.0, 434.0, 438.0, 441.0, 444.0, 447.0, 450.0};


    Double_t _p15_m[50] = {0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180,
                           0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180,
                           0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180,
                           0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180,
                           0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180};


    Double_t _len[18]   = {0.020, 0.060, 0.100, 0.140, 0.180, 0.220, 0.260, 0.300, 0.340, 0.380,
                           0.420, 0.460, 0.500, 0.540, 0.580, 0.620, 0.660, 0.700};

    Double_t _p01_l[18] = {0.960, 0.960, 0.960, 0.960, 0.960, 0.960, 0.980, 0.990, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p02_l[18] = {0.100, 0.100, 0.100, 0.100, 0.100, 0.100, 0.100, 0.124, 0.230, 0.336,
                           0.442, 0.548, 0.654, 0.760, 0.866, 0.972, 1.078, 1.184};

    Double_t _p03_l[18] = {0.556, 0.556, 0.556, 0.556, 0.562, 0.598, 0.634, 0.669, 0.705, 0.745,
                           0.785, 0.826, 0.868, 0.913, 0.954, 0.993, 1.033, 1.076};

    Double_t _p04_l[18] = {0.860, 0.860, 0.860, 0.860, 0.860, 0.860, 0.860, 0.860, 0.850, 0.830,
                           0.800, 0.800, 0.810, 0.870, 0.930, 0.990, 1.110, 1.180};

    Double_t _p05_l[18] = {0.880, 0.874, 0.864, 0.824, 0.781, 0.758, 0.727, 0.725, 0.730, 0.740,
                           0.755, 0.770, 0.789, 0.827, 0.886, 0.980, 1.099, 1.150};

    Double_t _p06_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p07_l[18] = {1.077, 1.072, 1.067, 1.062, 1.057, 1.052, 1.047, 1.042, 1.037, 1.032,
                           1.027, 1.022, 1.017, 1.012, 1.007, 1.002, 0.997, 0.992};

    Double_t _p08_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p09_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p10_l[18] = {0.740, 0.740, 0.740, 0.740, 0.740, 0.740, 0.760, 0.780, 0.800, 0.830,
                           0.860, 0.900, 0.940, 0.980, 0.990, 1.000, 1.000, 1.000};

    Double_t _p11_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p12_l[18] = {0.650, 0.650, 0.650, 0.650, 0.660, 0.670, 0.684, 0.710, 0.730, 0.750,
                           0.782, 0.822, 0.881, 0.950, 1.000, 1.033, 1.048, 1.064};

    Double_t _p13_l[18] = {0.625, 0.628, 0.633, 0.641, 0.681, 0.700, 0.722, 0.746, 0.784, 0.820,
                           0.856, 0.892, 0.928, 0.964, 1.000, 1.036, 1.070, 1.090};

    Double_t _p14_l[18] = {0.780, 0.780, 0.780, 0.780, 0.780, 0.780, 0.780, 0.788, 0.794, 0.814,
                           0.840, 0.877, 0.915, 0.960, 1.004, 1.034, 1.060, 1.080};

    Double_t _p15_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};



    Double_t _p01_n[20] = {0.998, 0.998, 0.998, 0.999, 0.999, 0.999, 0.999, 0.999, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.001, 1.001, 1.001, 1.001, 1.001, 1.002, 1.002};

    Double_t _p02_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p03_n[20] = {1.018, 1.016, 1.014, 1.013, 1.011, 1.009, 1.007, 1.005, 1.004, 1.002,
                           1.000, 0.998, 0.996, 0.995, 0.993, 0.991, 0.989, 0.987, 0.986, 0.984};

    Double_t _p04_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p05_n[20] = {1.029, 1.026, 1.023, 1.020, 1.017, 1.014, 1.011, 1.008, 1.005, 1.002,
                           0.999, 0.996, 0.993, 0.990, 0.987, 0.984, 0.981, 0.978, 0.975, 0.972};

    Double_t _p06_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p07_n[20] = {0.971, 0.974, 0.977, 0.980, 0.983, 0.986, 0.989, 0.992, 0.995, 0.998,
                           1.001, 1.004, 1.007, 1.010, 1.012, 1.015, 1.018, 1.021, 1.024, 1.027};

    Double_t _p08_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p09_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p10_n[20] = {0.986, 0.988, 0.989, 0.991, 0.992, 0.994, 0.995, 0.997, 0.998, 1.000,
                           1.001, 1.003, 1.004, 1.006, 1.007, 1.009, 1.010, 1.012, 1.013, 1.015};

    Double_t _p11_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p12_n[20] = {1.086, 1.083, 1.080, 1.077, 1.073, 1.068, 1.061, 1.053, 1.045, 1.036,
                           1.026, 1.016, 1.004, 0.991, 0.978, 0.959, 0.939, 0.909, 0.860, 0.740};

    Double_t _p13_n[20] = {1.015, 1.015, 1.015, 1.015, 1.015, 1.015, 1.015, 1.015, 1.015, 1.015,
                           1.015, 1.015, 1.015, 1.015, 1.010, 1.000, 0.990, 0.959, 0.943, 0.920};

    Double_t _p14_n[20] = {1.092, 1.091, 1.090, 1.089, 1.088, 1.085, 1.076, 1.070, 1.059, 1.047,
                           1.026, 1.016, 1.002, 0.986, 0.968, 0.948, 0.918, 0.884, 0.828, 0.760};

    Double_t _p15_n[20] = {0.900, 0.900, 0.900, 0.900, 0.900, 0.900, 0.900, 0.920, 0.935, 0.956,
                           0.984, 1.014, 1.044, 1.074, 1.104, 1.134, 1.164, 1.194, 1.224, 1.254};


    Double_t _c01_x[18] = {0.250, 0.290, 0.330, 0.370, 0.410, 0.450, 0.490, 0.520, 0.520, 0.490,
                           0.430, 0.370, 0.300, 0.230, 0.160, 0.100, 0.080, 0.080};

    Double_t _c02_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 10.00, 20.00, 30.00, 40.00, 50.00, 54.00};

    Double_t _c03_x[18] ={-52.00,-50.00,-46.00,-43.00,-40.00,-39.00,-35.00,-31.00,-28.00,-25.00,
                          -22.00,-20.000,-18.00,-16.00,-16.00,-16.00,-16.00,-16.00};

    Double_t _c04_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c05_x[18] ={-0.035,-0.038,-0.042,-0.046,-0.049,-0.053,-0.056,-0.059,-0.061,-0.059,
                          -0.056,-0.050,-0.043,-0.033,-0.023,-0.011, 0.003, 0.011};

    Double_t _c06_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c07_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000,-26.00,-72.00,-114.0,-143.0,-164.0,-175.0,-180.0};

    Double_t _c08_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c09_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c10_x[18] = {38.00, 42.00, 45.00, 48.00, 52.00, 56.00, 60.00, 61.00, 61.00, 55.00,
                           42.00, 26.00, 13.00,-4.000,-23.00,-36.00,-45.00,-50.00};

    Double_t _c11_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c12_x[18] = {0.080, 0.080, 0.080, 0.080, 0.080, 0.080, 0.080, 0.080, 0.080, 0.080,
                           0.090, 0.120, 0.160, 0.220, 0.270, 0.270, 0.270, 0.270};

    Double_t _c13_x[18] ={-500.0,-500.0,-500.0,-500.0,-500.0,-500.0,-500.0,-500.0,-500.0,-500.0,
                          -500.0,-500.0,-500.0,-500.0,-500.0,-500.0,-500.0,-500.0};

    Double_t _c14_x[18] ={-442.0,-442.0,-442.0,-442.0,-442.0,-442.0,-442.0,-442.0,-442.0,-442.0,
                          -442.0,-442.0,-442.0,-442.0,-442.0,-442.0,-442.0,-442.0};

    Double_t _c15_x[18] = {0.150, 0.150, 0.150, 0.150, 0.150, 0.150, 0.150, 0.150, 0.150, 0.150,
                           0.150, 0.150, 0.150, 0.150, 0.150, 0.150, 0.150, 0.150};
    //  Double_t _c15_x[18] = {0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300,
    //			0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300};





    memcpy(mom,_mom,sizeof(Double_t)*50);
    memcpy(p01_m,_p01_m,sizeof(Double_t)*50);
    memcpy(p02_m,_p02_m,sizeof(Double_t)*50);
    memcpy(p03_m,_p03_m,sizeof(Double_t)*50);
    memcpy(p04_m,_p04_m,sizeof(Double_t)*50);
    memcpy(p05_m,_p05_m,sizeof(Double_t)*50);
    memcpy(p06_m,_p06_m,sizeof(Double_t)*50);
    memcpy(p07_m,_p07_m,sizeof(Double_t)*50);
    memcpy(p08_m,_p08_m,sizeof(Double_t)*50);
    memcpy(p09_m,_p09_m,sizeof(Double_t)*50);
    memcpy(p10_m,_p10_m,sizeof(Double_t)*50);
    memcpy(p11_m,_p11_m,sizeof(Double_t)*50);
    memcpy(p12_m,_p12_m,sizeof(Double_t)*50);
    memcpy(p13_m,_p13_m,sizeof(Double_t)*50);
    memcpy(p14_m,_p14_m,sizeof(Double_t)*50);
    memcpy(p15_m,_p15_m,sizeof(Double_t)*50);

    memcpy(len,_len,sizeof(Double_t)*18);
    memcpy(p01_l,_p01_l,sizeof(Double_t)*18);
    memcpy(p02_l,_p02_l,sizeof(Double_t)*18);
    memcpy(p03_l,_p03_l,sizeof(Double_t)*18);
    memcpy(p04_l,_p04_l,sizeof(Double_t)*18);
    memcpy(p05_l,_p05_l,sizeof(Double_t)*18);
    memcpy(p06_l,_p06_l,sizeof(Double_t)*18);
    memcpy(p07_l,_p07_l,sizeof(Double_t)*18);
    memcpy(p08_l,_p08_l,sizeof(Double_t)*18);
    memcpy(p09_l,_p09_l,sizeof(Double_t)*18);
    memcpy(p10_l,_p10_l,sizeof(Double_t)*18);
    memcpy(p11_l,_p11_l,sizeof(Double_t)*18);
    memcpy(p12_l,_p12_l,sizeof(Double_t)*18);
    memcpy(p13_l,_p13_l,sizeof(Double_t)*18);
    memcpy(p14_l,_p14_l,sizeof(Double_t)*18);
    memcpy(p15_l,_p15_l,sizeof(Double_t)*18);


    memcpy(p01_n,_p01_n,sizeof(Double_t)*20);
    memcpy(p02_n,_p02_n,sizeof(Double_t)*20);
    memcpy(p03_n,_p03_n,sizeof(Double_t)*20);
    memcpy(p04_n,_p04_n,sizeof(Double_t)*20);
    memcpy(p05_n,_p05_n,sizeof(Double_t)*20);
    memcpy(p06_n,_p06_n,sizeof(Double_t)*20);
    memcpy(p07_n,_p07_n,sizeof(Double_t)*20);
    memcpy(p08_n,_p08_n,sizeof(Double_t)*20);
    memcpy(p09_n,_p09_n,sizeof(Double_t)*20);
    memcpy(p10_n,_p10_n,sizeof(Double_t)*20);
    memcpy(p11_n,_p11_n,sizeof(Double_t)*20);
    memcpy(p12_n,_p12_n,sizeof(Double_t)*20);
    memcpy(p13_n,_p13_n,sizeof(Double_t)*20);
    memcpy(p14_n,_p14_n,sizeof(Double_t)*20);
    memcpy(p15_n,_p15_n,sizeof(Double_t)*20);

    memcpy(c01_x,_c01_x,sizeof(Double_t)*18);
    memcpy(c02_x,_c02_x,sizeof(Double_t)*18);
    memcpy(c03_x,_c03_x,sizeof(Double_t)*18);
    memcpy(c04_x,_c04_x,sizeof(Double_t)*18);
    memcpy(c05_x,_c05_x,sizeof(Double_t)*18);
    memcpy(c06_x,_c06_x,sizeof(Double_t)*18);
    memcpy(c07_x,_c07_x,sizeof(Double_t)*18);
    memcpy(c08_x,_c08_x,sizeof(Double_t)*18);
    memcpy(c09_x,_c09_x,sizeof(Double_t)*18);
    memcpy(c10_x,_c10_x,sizeof(Double_t)*18);
    memcpy(c11_x,_c11_x,sizeof(Double_t)*18);
    memcpy(c12_x,_c12_x,sizeof(Double_t)*18);
    memcpy(c13_x,_c13_x,sizeof(Double_t)*18);
    memcpy(c14_x,_c14_x,sizeof(Double_t)*18);
    memcpy(c15_x,_c15_x,sizeof(Double_t)*18);



}

void TrdKPDF::Init_Electron(){



    Double_t _mom[40]   = {0.50,  1.50,  2.50,  3.50,  4.50,  5.50,  6.50,  7.50,  8.40,  9.40,
                           10.9,  12.8,  14.7,  16.6,  18.5,  21.4,  25.0,  29.0,  33.0,  37.0,
                           41.5,  49.5,  57.5,  65.5,  73.5,  83.0,  99.0,  115.,  131.,  147.,
                           168.,  208.,  248.,  288.,  328.,  440.,  540.,  640.,  740.,  840.};

    Double_t _p01_m[40] = {0.405, 0.410, 0.415, 0.425, 0.435, 0.443, 0.435, 0.425, 0.420, 0.417,
                           0.411, 0.405, 0.405, 0.405, 0.405, 0.405, 0.405, 0.405, 0.405, 0.405,
                           0.405, 0.405, 0.405, 0.405, 0.405, 0.405, 0.405, 0.405, 0.405, 0.405,
                           0.405, 0.405, 0.405, 0.405, 0.405, 0.405, 0.405, 0.405, 0.405, 0.405};

    Double_t _p02_m[40] = {90.00, 96.80, 103.6, 108.8, 113.2, 116.2, 117.8, 118.8, 119.4, 119.7,
                           119.9, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0,
                           120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0,
                           120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0, 120.0};

    Double_t _p03_m[40] = {95.80, 95.00, 94.50, 94.20, 93.90, 93.60, 93.30, 93.00, 92.70, 92.40,
                           92.10, 91.90, 91.80, 91.80, 91.80, 91.80, 91.90, 92.00, 92.00, 92.00,
                           92.00, 92.00, 92.00, 92.00, 92.00, 92.00, 92.00, 92.00, 92.00, 92.00,
                           92.00, 92.00, 92.00, 92.00, 92.00, 92.00, 92.00, 92.00, 92.00, 92.00};

    Double_t _p04_m[40] = {0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540,
                           0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540,
                           0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540,
                           0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540, 0.540};

    Double_t _p05_m[40] = {0.400, 0.418, 0.432, 0.448, 0.462, 0.472, 0.479, 0.484, 0.487, 0.489,
                           0.490, 0.490, 0.490, 0.490, 0.490, 0.490, 0.490, 0.490, 0.490, 0.490,
                           0.490, 0.490, 0.490, 0.490, 0.490, 0.490, 0.490, 0.490, 0.490, 0.490,
                           0.490, 0.490, 0.490, 0.490, 0.490, 0.490, 0.490, 0.490, 0.490, 0.490};

    Double_t _p06_m[40] = {440.0, 462.0, 479.0, 493.0, 501.0, 507.0, 511.0, 514.0, 516.0, 518.0,
                           520.0, 522.0, 523.0, 524.0, 525.0, 525.0, 525.0, 525.0, 525.0, 525.0,
                           525.0, 525.0, 525.0, 525.0, 525.0, 525.0, 525.0, 525.0, 525.0, 525.0,
                           525.0, 525.0, 525.0, 525.0, 525.0, 525.0, 525.0, 525.0, 525.0, 525.0};

    Double_t _p07_m[40] = {427.0, 434.0, 441.0, 448.0, 455.0, 462.0, 468.0, 472.0, 475.0, 477.0,
                           478.0, 479.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0,
                           480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0,
                           480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0};

    Double_t _p08_m[40] = {0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180,
                           0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180,
                           0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180,
                           0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180, 0.180};

    Double_t _p09_m[40] = {600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0,
                           600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0,
                           600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0,
                           600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0};

    Double_t _p10_m[40] = {700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0,
                           700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0,
                           700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0,
                           700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0, 700.0};

    Double_t _p11_m[40] = {0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500,
                           0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500,
                           0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500,
                           0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500};


    Double_t _len[18]   = {0.020, 0.060, 0.100, 0.140, 0.180, 0.220, 0.260, 0.300, 0.340, 0.380,
                           0.420, 0.460, 0.500, 0.540, 0.580, 0.620, 0.660, 0.700};

    Double_t _p01_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p02_l[18] = {0.220, 0.220, 0.220, 0.228, 0.254, 0.280, 0.307, 0.339, 0.382, 0.444,
                           0.530, 0.640, 0.760, 0.875, 1.000, 1.080, 1.150, 1.200};

    Double_t _p03_l[18] = {0.800, 0.800, 0.800, 0.800, 0.810, 0.824, 0.844, 0.865, 0.883, 0.901,
                           0.921, 0.940, 0.958, 0.980, 1.000, 1.010, 1.018, 1.020};

    Double_t _p04_l[18] = {0.400, 0.400, 0.400, 0.400, 0.400, 0.400, 0.410, 0.420, 0.450, 0.500,
                           0.603, 0.779, 0.928, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p05_l[18] = {0.650, 0.650, 0.650, 0.650, 0.660, 0.670, 0.684, 0.710, 0.730, 0.750,
                           0.782, 0.822, 0.881, 0.950, 1.000, 1.033, 1.048, 1.064};

    Double_t _p06_l[18] = {0.625, 0.628, 0.633, 0.641, 0.681, 0.700, 0.722, 0.746, 0.784, 0.820,
                           0.856, 0.892, 0.928, 0.964, 1.000, 1.036, 1.070, 1.090};

    Double_t _p07_l[18] = {0.780, 0.780, 0.780, 0.780, 0.780, 0.780, 0.780, 0.788, 0.794, 0.814,
                           0.840, 0.877, 0.915, 0.960, 1.004, 1.034, 1.060, 1.080};

    Double_t _p08_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p09_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p10_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p11_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};


    Double_t _p01_n[20] = {0.950, 0.950, 0.950, 0.950, 0.950, 0.950, 0.958, 0.978, 0.990, 1.000,
                           1.020, 1.040, 1.060, 1.080, 1.100, 1.120, 1.140, 1.160, 1.180, 1.200};

    Double_t _p02_n[20] = {1.031, 1.026, 1.022, 1.018, 1.014, 1.010, 1.006, 1.001, 0.997, 0.993,
                           0.990, 0.988, 0.986, 0.986, 0.986, 0.986, 0.986, 0.986, 0.986, 0.986};

    Double_t _p03_n[20] = {0.945, 0.951, 0.956, 0.962, 0.967, 0.973, 0.978, 0.984, 0.989, 0.995,
                           1.000, 1.006, 1.011, 1.017, 1.022, 1.028, 1.033, 1.039, 1.044, 1.050};

    Double_t _p04_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p05_n[20] = {1.086, 1.083, 1.080, 1.077, 1.073, 1.068, 1.061, 1.053, 1.045, 1.036,
                           1.026, 1.016, 1.004, 0.991, 0.978, 0.959, 0.939, 0.909, 0.860, 0.740};

    Double_t _p06_n[20] = {1.015, 1.015, 1.015, 1.015, 1.015, 1.015, 1.015, 1.015, 1.015, 1.015,
                           1.015, 1.015, 1.015, 1.015, 1.010, 1.000, 0.990, 0.959, 0.943, 0.920};

    Double_t _p07_n[20] = {1.092, 1.091, 1.090, 1.089, 1.088, 1.085, 1.076, 1.070, 1.059, 1.047,
                           1.026, 1.016, 1.002, 0.986, 0.968, 0.948, 0.918, 0.884, 0.828, 0.760};

    Double_t _p08_n[20] = {0.900, 0.900, 0.900, 0.900, 0.900, 0.900, 0.900, 0.920, 0.935, 0.956,
                           0.984, 1.014, 1.044, 1.074, 1.104, 1.134, 1.164, 1.194, 1.224, 1.254};

    Double_t _p09_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p10_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p11_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};


    Double_t _c01_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c02_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c03_x[18] ={-60.00,-60.00,-60.00,-60.00,-60.00,-60.00,-60.00,-60.00,-60.00,-60.00,
                          -60.00,-60.00,-60.00,-60.00,-60.00,-60.00,-60.00,-60.00};

    Double_t _c04_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c05_x[18] = {0.080, 0.080, 0.080, 0.080, 0.080, 0.080, 0.080, 0.080, 0.080, 0.080,
                           0.090, 0.120, 0.160, 0.220, 0.270, 0.270, 0.270, 0.270};

    Double_t _c06_x[18] ={-500.0,-500.0,-500.0,-500.0,-500.0,-500.0,-500.0,-500.0,-500.0,-500.0,
                          -500.0,-500.0,-500.0,-500.0,-500.0,-500.0,-500.0,-500.0};

    Double_t _c07_x[18] ={-442.0,-442.0,-442.0,-442.0,-442.0,-442.0,-442.0,-442.0,-442.0,-442.0,
                          -442.0,-442.0,-442.0,-442.0,-442.0,-442.0,-442.0,-442.0};

    //    Double_t _c08_x[18] = {0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300,
    //                           0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300, 0.300};

    Double_t _c08_x[18] = {0.150, 0.150, 0.150, 0.150, 0.150, 0.150, 0.150, 0.150, 0.150, 0.150,
                           0.150, 0.150, 0.150, 0.150, 0.150, 0.150, 0.150, 0.150};

    Double_t _c09_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c10_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c11_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};



    memcpy(mom,_mom,sizeof(Double_t)*40);
    memcpy(p01_m,_p01_m,sizeof(Double_t)*40);
    memcpy(p02_m,_p02_m,sizeof(Double_t)*40);
    memcpy(p03_m,_p03_m,sizeof(Double_t)*40);
    memcpy(p04_m,_p04_m,sizeof(Double_t)*40);
    memcpy(p05_m,_p05_m,sizeof(Double_t)*40);
    memcpy(p06_m,_p06_m,sizeof(Double_t)*40);
    memcpy(p07_m,_p07_m,sizeof(Double_t)*40);
    memcpy(p08_m,_p08_m,sizeof(Double_t)*40);
    memcpy(p09_m,_p09_m,sizeof(Double_t)*40);
    memcpy(p10_m,_p10_m,sizeof(Double_t)*40);
    memcpy(p11_m,_p11_m,sizeof(Double_t)*40);

    memcpy(len,_len,sizeof(Double_t)*18);
    memcpy(p01_l,_p01_l,sizeof(Double_t)*18);
    memcpy(p02_l,_p02_l,sizeof(Double_t)*18);
    memcpy(p03_l,_p03_l,sizeof(Double_t)*18);
    memcpy(p04_l,_p04_l,sizeof(Double_t)*18);
    memcpy(p05_l,_p05_l,sizeof(Double_t)*18);
    memcpy(p06_l,_p06_l,sizeof(Double_t)*18);
    memcpy(p07_l,_p07_l,sizeof(Double_t)*18);
    memcpy(p08_l,_p08_l,sizeof(Double_t)*18);
    memcpy(p09_l,_p09_l,sizeof(Double_t)*18);
    memcpy(p10_l,_p10_l,sizeof(Double_t)*18);
    memcpy(p11_l,_p11_l,sizeof(Double_t)*18);


    memcpy(p01_n,_p01_n,sizeof(Double_t)*20);
    memcpy(p02_n,_p02_n,sizeof(Double_t)*20);
    memcpy(p03_n,_p03_n,sizeof(Double_t)*20);
    memcpy(p04_n,_p04_n,sizeof(Double_t)*20);
    memcpy(p05_n,_p05_n,sizeof(Double_t)*20);
    memcpy(p06_n,_p06_n,sizeof(Double_t)*20);
    memcpy(p07_n,_p07_n,sizeof(Double_t)*20);
    memcpy(p08_n,_p08_n,sizeof(Double_t)*20);
    memcpy(p09_n,_p09_n,sizeof(Double_t)*20);
    memcpy(p10_n,_p10_n,sizeof(Double_t)*20);
    memcpy(p11_n,_p11_n,sizeof(Double_t)*20);

    memcpy(c01_x,_c01_x,sizeof(Double_t)*18);
    memcpy(c02_x,_c02_x,sizeof(Double_t)*18);
    memcpy(c03_x,_c03_x,sizeof(Double_t)*18);
    memcpy(c04_x,_c04_x,sizeof(Double_t)*18);
    memcpy(c05_x,_c05_x,sizeof(Double_t)*18);
    memcpy(c06_x,_c06_x,sizeof(Double_t)*18);
    memcpy(c07_x,_c07_x,sizeof(Double_t)*18);
    memcpy(c08_x,_c08_x,sizeof(Double_t)*18);
    memcpy(c09_x,_c09_x,sizeof(Double_t)*18);
    memcpy(c10_x,_c10_x,sizeof(Double_t)*18);
    memcpy(c11_x,_c11_x,sizeof(Double_t)*18);



}

void TrdKPDF::Init_Helium(){

    Double_t _mom[40]   = {0.50,  1.50,  2.50,  3.50,  4.50,  5.50,  6.50,  7.50,  8.40,  9.40,
                           10.9,  12.8,  14.7,  16.6,  18.5,  21.4,  25.0,  29.0,  33.0,  37.0,
                           41.5,  49.5,  57.5,  65.5,  73.5,  83.0,  99.0,  115.,  131.,  147.,
                           168.,  208.,  248.,  288.,  328.,  440.,  540.,  640.,  740.,  840.};

    Double_t _p01_m[40] = {0.740, 0.759, 0.784, 0.809, 0.823, 0.832, 0.837, 0.838, 0.838, 0.838,
                           0.838, 0.838, 0.837, 0.835, 0.834, 0.832, 0.831, 0.830, 0.830, 0.830,
                           0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830,
                           0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830};

    Double_t _p02_m[40] = {600.0, 530.0, 435.4, 390.9, 380.1, 377.5, 377.8, 386.4, 390.6, 395.2,
                           401.9, 410.4, 418.4, 425.1, 431.6, 440.2, 449.8, 458.3, 465.8, 472.7,
                           479.5, 488.9, 495.9, 501.8, 506.0, 511.5, 517.8, 521.1, 524.5, 527.0,
                           529.0, 530.6, 531.8, 532.8, 533.6, 534.2, 534.4, 534.5, 534.6, 534.6};

    Double_t _p03_m[40] = {350.0, 282.0, 210.0, 188.2, 180.6, 179.2, 179.6, 179.9, 180.3, 181.1,
                           182.5, 183.9, 185.7, 186.5, 187.9, 190.1, 191.5, 193.8, 195.9, 197.5,
                           198.9, 201.7, 204.2, 206.8, 208.7, 211.6, 215.4, 216.9, 221.0, 223.6,
                           225.8, 227.6, 229.0, 230.2, 231.2, 232.0, 232.6, 233.0, 233.2, 233.3};

    Double_t _p04_m[40] = {0.600, 0.590, 0.580, 0.560, 0.550, 0.540, 0.547, 0.549, 0.551, 0.556,
                           0.559, 0.564, 0.570, 0.575, 0.580, 0.586, 0.590, 0.597, 0.603, 0.609,
                           0.615, 0.621, 0.627, 0.633, 0.639, 0.645, 0.651, 0.657, 0.663, 0.669,
                           0.675, 0.681, 0.687, 0.693, 0.699, 0.700, 0.700, 0.700, 0.700, 0.700};

    Double_t _p05_m[40] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _p06_m[40] = {500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0,
                           500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0,
                           500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0,
                           500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0};

    Double_t _p07_m[40] = {600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0,
                           600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0,
                           600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0,
                           600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0};

    Double_t _p08_m[40] = {0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500,
                           0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500,
                           0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500,
                           0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500};

    Double_t _p09_m[40] = {710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0,
                           710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0,
                           710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0,
                           710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0};

    Double_t _p10_m[40] = {860.0, 798.0, 660.1, 625.5, 618.0, 615.2, 614.0, 612.4, 612.0, 610.4,
                           609.6, 607.0, 605.5, 603.5, 601.6, 602.3, 602.2, 602.2, 602.2, 602.2,
                           603.0, 605.0, 609.0, 613.0, 617.0, 621.0, 624.0, 627.0, 629.0, 630.0,
                           630.0, 630.0, 630.0, 630.0, 630.0, 630.0, 630.0, 630.0, 630.0, 630.0};

    Double_t _p11_m[40] = {0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250,
                           0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250,
                           0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250,
                           0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250};


    Double_t _len[18]   = {0.020, 0.060, 0.100, 0.140, 0.180, 0.220, 0.260, 0.300, 0.340, 0.380,
                           0.420, 0.460, 0.500, 0.540, 0.580, 0.620, 0.660, 0.700};

    Double_t _p01_l[18] = {1.090, 1.090, 1.090, 1.093, 1.096, 1.101, 1.105, 1.108, 1.108, 1.105,
                           1.098, 1.087, 1.072, 1.051, 1.026, 1.000, 0.964, 0.930};

    Double_t _p02_l[18] = {0.190, 0.190, 0.190, 0.199, 0.225, 0.255, 0.297, 0.356, 0.425, 0.501,
                           0.580, 0.666, 0.754, 0.839, 0.926, 0.989, 1.070, 1.150};

    Double_t _p03_l[18] = {0.900, 0.880, 0.865, 0.857, 0.853, 0.850, 0.851, 0.854, 0.866, 0.877,
                           0.883, 0.905, 0.924, 0.944, 0.962, 0.990, 1.040, 1.090};

    Double_t _p04_l[18] = {0.450, 0.450, 0.460, 0.480, 0.520, 0.590, 0.640, 0.700, 0.745, 0.805,
                           0.870, 0.920, 0.950, 0.980, 1.000, 1.000, 1.000, 1.000};

    Double_t _p05_l[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _p06_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p07_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p08_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p09_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p10_l[18] = {1.260, 1.243, 1.225, 1.208, 1.190, 1.172, 1.154, 1.136, 1.119, 1.101,
                           1.093, 1.075, 1.057, 1.040, 1.022, 1.004, 0.986, 0.968};

    Double_t _p11_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};


    Double_t _p01_n[20] = {0.986, 0.987, 0.989, 0.990, 0.992, 0.993, 0.995, 0.996, 0.998, 0.999,
                           1.001, 1.002, 1.004, 1.005, 1.007, 1.008, 1.010, 1.011, 1.013, 1.014};

    Double_t _p02_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p03_n[20] = {0.985, 0.986, 0.988, 0.990, 0.991, 0.993, 0.995, 0.996, 0.998, 1.000,
                           1.001, 1.003, 1.005, 1.006, 1.008, 1.010, 1.011, 1.013, 1.015, 1.016};

    Double_t _p04_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p05_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p06_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p07_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p08_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p09_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p10_n[20] = {0.955, 0.960, 0.965, 0.970, 0.975, 0.980, 0.985, 0.990, 0.995, 1.000,
                           1.005, 1.010, 1.015, 1.020, 1.025, 1.030, 1.035, 1.040, 1.045, 1.050};

    Double_t _p11_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};


    Double_t _c01_x[18] = {0.120, 0.120, 0.120, 0.120, 0.120, 0.120, 0.120, 0.120, 0.120, 0.140,
                           0.160, 0.160, 0.150, 0.140, 0.120, 0.100, 0.100, 0.100};

    Double_t _c02_x[18] ={-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,
                          -260.0,-210.0,-160.0,-90.00,-30.00, 30.00, 80.00, 100.0};

    Double_t _c03_x[18] ={-220.0,-220.0,-220.0,-220.0,-220.0,-220.0,-220.0,-220.0,-200.0,-175.0,
                          -150.0,-125.0,-100.0,-80.00,-65.00,-52.00,-50.00,-50.00};

    Double_t _c04_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c05_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c06_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c07_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c08_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c09_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c10_x[18] ={-580.0,-550.0,-520.0,-490.0,-460.0,-430.0,-400.0,-370.0,-340.0,-310.0,
                          -280.0,-250.0,-240.0,-220.0,-210.0,-210.0,-210.0,-210.0};

    Double_t _c11_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};




    memcpy(mom,_mom,sizeof(Double_t)*40);
    memcpy(p01_m,_p01_m,sizeof(Double_t)*40);
    memcpy(p02_m,_p02_m,sizeof(Double_t)*40);
    memcpy(p03_m,_p03_m,sizeof(Double_t)*40);
    memcpy(p04_m,_p04_m,sizeof(Double_t)*40);
    memcpy(p05_m,_p05_m,sizeof(Double_t)*40);
    memcpy(p06_m,_p06_m,sizeof(Double_t)*40);
    memcpy(p07_m,_p07_m,sizeof(Double_t)*40);
    memcpy(p08_m,_p08_m,sizeof(Double_t)*40);
    memcpy(p09_m,_p09_m,sizeof(Double_t)*40);
    memcpy(p10_m,_p10_m,sizeof(Double_t)*40);
    memcpy(p11_m,_p11_m,sizeof(Double_t)*40);

    memcpy(len,_len,sizeof(Double_t)*18);
    memcpy(p01_l,_p01_l,sizeof(Double_t)*18);
    memcpy(p02_l,_p02_l,sizeof(Double_t)*18);
    memcpy(p03_l,_p03_l,sizeof(Double_t)*18);
    memcpy(p04_l,_p04_l,sizeof(Double_t)*18);
    memcpy(p05_l,_p05_l,sizeof(Double_t)*18);
    memcpy(p06_l,_p06_l,sizeof(Double_t)*18);
    memcpy(p07_l,_p07_l,sizeof(Double_t)*18);
    memcpy(p08_l,_p08_l,sizeof(Double_t)*18);
    memcpy(p09_l,_p09_l,sizeof(Double_t)*18);
    memcpy(p10_l,_p10_l,sizeof(Double_t)*18);
    memcpy(p11_l,_p11_l,sizeof(Double_t)*18);


    memcpy(p01_n,_p01_n,sizeof(Double_t)*20);
    memcpy(p02_n,_p02_n,sizeof(Double_t)*20);
    memcpy(p03_n,_p03_n,sizeof(Double_t)*20);
    memcpy(p04_n,_p04_n,sizeof(Double_t)*20);
    memcpy(p05_n,_p05_n,sizeof(Double_t)*20);
    memcpy(p06_n,_p06_n,sizeof(Double_t)*20);
    memcpy(p07_n,_p07_n,sizeof(Double_t)*20);
    memcpy(p08_n,_p08_n,sizeof(Double_t)*20);
    memcpy(p09_n,_p09_n,sizeof(Double_t)*20);
    memcpy(p10_n,_p10_n,sizeof(Double_t)*20);
    memcpy(p11_n,_p11_n,sizeof(Double_t)*20);

    memcpy(c01_x,_c01_x,sizeof(Double_t)*18);
    memcpy(c02_x,_c02_x,sizeof(Double_t)*18);
    memcpy(c03_x,_c03_x,sizeof(Double_t)*18);
    memcpy(c04_x,_c04_x,sizeof(Double_t)*18);
    memcpy(c05_x,_c05_x,sizeof(Double_t)*18);
    memcpy(c06_x,_c06_x,sizeof(Double_t)*18);
    memcpy(c07_x,_c07_x,sizeof(Double_t)*18);
    memcpy(c08_x,_c08_x,sizeof(Double_t)*18);
    memcpy(c09_x,_c09_x,sizeof(Double_t)*18);
    memcpy(c10_x,_c10_x,sizeof(Double_t)*18);
    memcpy(c11_x,_c11_x,sizeof(Double_t)*18);



}

Double_t TrdKPDF::GetNormalization(double start=0){
    //    return  Par[0]*func_li(start,Par[1],Par[2],Par[3]) + Par[4]*func_li(start,Par[5],Par[6],Par[7]) + (1.-Par[0]-Par[4])*func_li(start,Par[8],Par[9],Par[10]);

    return (1.-Par[11])*(Par[0]*func_li(start,Par[1],Par[2],Par[3]) + Par[4]*func_li(start,Par[5],Par[6],Par[7])
                         +(1.-Par[0]-Par[4])*func_li(start,Par[8],Par[9],Par[10])) + Par[11]*func_li(start,Par[12],Par[13],Par[14]);

}

Double_t TrdKPDF::GetLikelihood(double Amp, float Corr){

    if(Normalization_Method==0)Norm=1.0;
    else Norm=GetNormalization(Normalization_Start);

    float x,v;

    if ( Amp<15.*Corr ) {
        x=Amp;
        //        v= (1.-Par[11])*(Par[0]*func_l(Amp,Par[1],Par[2],Par[3]) + Par[4]*func_l(Amp,Par[5],Par[6],Par[7])
        //                         +(1.-Par[0]-Par[4])*func_l(Amp,Par[8],Par[9],Par[10])) + Par[11]*func_l(Amp,Par[12],Par[13],Par[14]);
        v=1-(GetNormalization(x));
        v/=Norm;
    } else if ( Amp >= 3400. ) {
        x = 3400.;
        v = GetNormalization(x);
        v/=Norm;
    } else if ( Amp > 3400.*Corr ) {
        x = 3400.*Corr;
        v = GetNormalization(x);
        v/=Norm;
    } else {
        x = Amp;
        v= (1.-Par[11])*(Par[0]*func_l(Amp,Par[1],Par[2],Par[3]) + Par[4]*func_l(Amp,Par[5],Par[6],Par[7])
                         +(1.-Par[0]-Par[4])*func_l(Amp,Par[8],Par[9],Par[10])) + Par[11]*func_l(Amp,Par[12],Par[13],Par[14]);
        v/=Norm;
    }
    return  v;
}

void TrdKPDF::GetPar_Proton(Double_t Pmom, Double_t Length, Int_t Layer, Double_t Press){


    Int_t    ii, i1_m, i2_m, i1_l, i2_l, i1_n;
    Double_t dt_m, dt_l;


    // momentum correction
    if ( Pmom < 0 ) Pmom *= -1.;
    if ( Pmom > mom[48] ) {
        i1_m = 48;
        i2_m = 49;
        dt_m = 0.;
    } else {
        i1_m = 0;
        i2_m = 48;
        ii   = (i1_m+i2_m)/2;
        while ( ii > i1_m ) {
            if ( Pmom >= mom[ii] ) i1_m = ii;
            else                   i2_m = ii;
            ii = (i1_m+i2_m)/2;
        }
        dt_m = (Pmom - mom[i1_m])/(mom[i2_m] - mom[i1_m]);
    }



    // pathlength correction
    i1_l = (int)((Length-len[0])/0.04);
    if ( i1_l < 0  ) i1_l = 0;
    if ( i1_l > 16 ) i1_l = 16;
    i2_l = i1_l +1;
    dt_l = (Length - len[i1_l])/(len[i2_l] - len[i1_l]);
    if ( dt_l > 1. ) dt_l = 1.;

    // layer correction
    i1_n = Layer;
    if ( i1_n < 0 )  i1_n = 0;
    if ( i1_n > 19 ) i1_n = 19;


    Par[0] = (p01_m[i1_m] + dt_m*(p01_m[i2_m]-p01_m[i1_m]))*(p01_l[i1_l] + dt_l*(p01_l[i2_l]-p01_l[i1_l]))*p01_n[i1_n]
            + (c01_x[i1_l] + dt_l*(c01_x[i2_l]-c01_x[i1_l]))*(Press-0.800);
    Par[1] = (p02_m[i1_m] + dt_m*(p02_m[i2_m]-p02_m[i1_m]))*(p02_l[i1_l] + dt_l*(p02_l[i2_l]-p02_l[i1_l]))*p02_n[i1_n]
            + (c02_x[i1_l] + dt_l*(c02_x[i2_l]-c02_x[i1_l]))*(Press-0.800);
    Par[2] = (p03_m[i1_m] + dt_m*(p03_m[i2_m]-p03_m[i1_m]))*(p03_l[i1_l] + dt_l*(p03_l[i2_l]-p03_l[i1_l]))*p03_n[i1_n]
            + (c03_x[i1_l] + dt_l*(c03_x[i2_l]-c03_x[i1_l]))*(Press-0.800);
    Par[3] = (p04_m[i1_m] + dt_m*(p04_m[i2_m]-p04_m[i1_m]))*(p04_l[i1_l] + dt_l*(p04_l[i2_l]-p04_l[i1_l]))*p04_n[i1_n]
            + (c04_x[i1_l] + dt_l*(c04_x[i2_l]-c04_x[i1_l]))*(Press-0.800);

    Par[3]*=0.93;


    Par[4] = (p05_m[i1_m] + dt_m*(p05_m[i2_m]-p05_m[i1_m]))*(p05_l[i1_l] + dt_l*(p05_l[i2_l]-p05_l[i1_l]))*p05_n[i1_n]
            + (c05_x[i1_l] + dt_l*(c05_x[i2_l]-c05_x[i1_l]))*(Press-0.800);
    Par[5] = (p06_m[i1_m] + dt_m*(p06_m[i2_m]-p06_m[i1_m]))*(p06_l[i1_l] + dt_l*(p06_l[i2_l]-p06_l[i1_l]))*p06_n[i1_n]
            + (c06_x[i1_l] + dt_l*(c06_x[i2_l]-c06_x[i1_l]))*(Press-0.800);
    Par[6] = (p07_m[i1_m] + dt_m*(p07_m[i2_m]-p07_m[i1_m]))*(p07_l[i1_l] + dt_l*(p07_l[i2_l]-p07_l[i1_l]))*p07_n[i1_n]
            + (c07_x[i1_l] + dt_l*(c07_x[i2_l]-c07_x[i1_l]))*(Press-0.800);
    Par[7] = (p08_m[i1_m] + dt_m*(p08_m[i2_m]-p08_m[i1_m]))*(p08_l[i1_l] + dt_l*(p08_l[i2_l]-p08_l[i1_l]))*p08_n[i1_n]
            + (c08_x[i1_l] + dt_l*(c08_x[i2_l]-c08_x[i1_l]))*(Press-0.800);
    Par[8] = 2.0*Par[1];
    Par[9] = (p10_m[i1_m] + dt_m*(p10_m[i2_m]-p10_m[i1_m]))*(p10_l[i1_l] + dt_l*(p10_l[i2_l]-p10_l[i1_l]))*p10_n[i1_n]
            + (c10_x[i1_l] + dt_l*(c10_x[i2_l]-c10_x[i1_l]))*(Press-0.800);
    Par[10]= (p11_m[i1_m] + dt_m*(p11_m[i2_m]-p11_m[i1_m]))*(p11_l[i1_l] + dt_l*(p11_l[i2_l]-p11_l[i1_l]))*p11_n[i1_n]
            + (c11_x[i1_l] + dt_l*(c11_x[i2_l]-c11_x[i1_l]))*(Press-0.800);

    Par[11]= (p12_m[i1_m] + dt_m*(p12_m[i2_m]-p12_m[i1_m]))*(p12_l[i1_l] + dt_l*(p12_l[i2_l]-p12_l[i1_l]))*p12_n[i1_n]
            + (p12_m[i1_m] + dt_m*(p12_m[i2_m]-p12_m[i1_m]))*(c12_x[i1_l] + dt_l*(c12_x[i2_l]-c12_x[i1_l]))*(Press-0.800)/0.5;
    Par[12]= (p13_m[i1_m] + dt_m*(p13_m[i2_m]-p13_m[i1_m]))*(p13_l[i1_l] + dt_l*(p13_l[i2_l]-p13_l[i1_l]))*p13_n[i1_n]
            + (c13_x[i1_l] + dt_l*(c13_x[i2_l]-c13_x[i1_l]))*(Press-0.800);
    Par[13]= (p14_m[i1_m] + dt_m*(p14_m[i2_m]-p14_m[i1_m]))*(p14_l[i1_l] + dt_l*(p14_l[i2_l]-p14_l[i1_l]))*p14_n[i1_n]
            + (c14_x[i1_l] + dt_l*(c14_x[i2_l]-c14_x[i1_l]))*(Press-0.800);
    Par[14]= (p15_m[i1_m] + dt_m*(p15_m[i2_m]-p15_m[i1_m]))*(p15_l[i1_l] + dt_l*(p15_l[i2_l]-p15_l[i1_l]))*p15_n[i1_n]
            + (c15_x[i1_l] + dt_l*(c15_x[i2_l]-c15_x[i1_l]))*(Press-0.800);


};

void TrdKPDF::GetPar_Electron(Double_t Pmom, Double_t Length, Int_t Layer, Double_t Press){

    Int_t    ii, i1_m, i2_m, i1_l, i2_l, i1_n;
    Double_t dt_m, dt_l;

    // momentum correction
    if ( Pmom < 0 ) Pmom = 0.;
    if ( Pmom > mom[38] ) {
        i1_m = 38;
        i2_m = 39;
        dt_m = 0.;
    } else {
        i1_m = 0;
        i2_m = 38;
        ii   = (i1_m+i2_m)/2;
        while ( ii > i1_m ) {
            if ( Pmom >= mom[ii] ) i1_m = ii;
            else                   i2_m = ii;
            ii = (i1_m+i2_m)/2;
        }
        dt_m = (Pmom - mom[i1_m])/(mom[i2_m] - mom[i1_m]);
    }

    // pathlength correction
    i1_l = (int)((Length-len[0])/0.04);
    if ( i1_l < 0  ) i1_l = 0;
    if ( i1_l > 16 ) i1_l = 16;
    i2_l = i1_l +1;
    dt_l = (Length - len[i1_l])/(len[i2_l] - len[i1_l]);
    if ( dt_l > 1. ) dt_l = 1.;

    // layer correction
    i1_n = Layer;
    if ( i1_n < 0 )  i1_n = 0;
    if ( i1_n > 19 ) i1_n = 19;

    Par[1] = (p02_m[i1_m] + dt_m*(p02_m[i2_m]-p02_m[i1_m]))*(p02_l[i1_l] + dt_l*(p02_l[i2_l]-p02_l[i1_l]))*p02_n[i1_n]
            + (c02_x[i1_l] + dt_l*(c02_x[i2_l]-c02_x[i1_l]))*(Press-0.800);
    Par[2] = (p03_m[i1_m] + dt_m*(p03_m[i2_m]-p03_m[i1_m]))*(p03_l[i1_l] + dt_l*(p03_l[i2_l]-p03_l[i1_l]))*p03_n[i1_n]
            + (c03_x[i1_l] + dt_l*(c03_x[i2_l]-c03_x[i1_l]))*(Press-0.800);
    Par[3] = (p04_m[i1_m] + dt_m*(p04_m[i2_m]-p04_m[i1_m]))*(p04_l[i1_l] + dt_l*(p04_l[i2_l]-p04_l[i1_l]))*p04_n[i1_n]
            + (c04_x[i1_l] + dt_l*(c04_x[i2_l]-c04_x[i1_l]))*(Press-0.800);


    Par[3]*=0.74;

    Par[4] = (p05_m[i1_m] + dt_m*(p05_m[i2_m]-p05_m[i1_m]))*(p05_l[i1_l] + dt_l*(p05_l[i2_l]-p05_l[i1_l]))*p05_n[i1_n]
            + (c05_x[i1_l] + dt_l*(c05_x[i2_l]-c05_x[i1_l]))*(Press-0.800);
    Par[5] = (p06_m[i1_m] + dt_m*(p06_m[i2_m]-p06_m[i1_m]))*(p06_l[i1_l] + dt_l*(p06_l[i2_l]-p06_l[i1_l]))*p06_n[i1_n]
            + (c06_x[i1_l] + dt_l*(c06_x[i2_l]-c06_x[i1_l]))*(Press-0.800);
    Par[6] = (p07_m[i1_m] + dt_m*(p07_m[i2_m]-p07_m[i1_m]))*(p07_l[i1_l] + dt_l*(p07_l[i2_l]-p07_l[i1_l]))*p07_n[i1_n]
            + (c07_x[i1_l] + dt_l*(c07_x[i2_l]-c07_x[i1_l]))*(Press-0.800);
    Par[7] = (p08_m[i1_m] + dt_m*(p08_m[i2_m]-p08_m[i1_m]))*(p08_l[i1_l] + dt_l*(p08_l[i2_l]-p08_l[i1_l]))*p08_n[i1_n]
            + (c08_x[i1_l] + dt_l*(c08_x[i2_l]-c08_x[i1_l]))*(Press-0.800);
    Par[8] = (p09_m[i1_m] + dt_m*(p09_m[i2_m]-p09_m[i1_m]))*(p09_l[i1_l] + dt_l*(p09_l[i2_l]-p09_l[i1_l]))*p09_n[i1_n]
            + (c09_x[i1_l] + dt_l*(c09_x[i2_l]-c09_x[i1_l]))*(Press-0.800);
    Par[9] = (p10_m[i1_m] + dt_m*(p10_m[i2_m]-p10_m[i1_m]))*(p10_l[i1_l] + dt_l*(p10_l[i2_l]-p10_l[i1_l]))*p10_n[i1_n]
            + (c10_x[i1_l] + dt_l*(c10_x[i2_l]-c10_x[i1_l]))*(Press-0.800);
    Par[10]= (p11_m[i1_m] + dt_m*(p11_m[i2_m]-p11_m[i1_m]))*(p11_l[i1_l] + dt_l*(p11_l[i2_l]-p11_l[i1_l]))*p11_n[i1_n]
            + (c11_x[i1_l] + dt_l*(c11_x[i2_l]-c11_x[i1_l]))*(Press-0.800);
    Par[11]= 0.0;
    Par[12]= 0.0;
    Par[13]= 0.0;
    Par[14]= 0.0;
    Par[0] = 1.0 - Par[4];

    Par[1] *= 0.97;


}

void TrdKPDF::GetPar_Helium(Double_t Pmom, Double_t Length, Int_t Layer, Double_t Press){

    Int_t    ii, i1_m, i2_m, i1_l, i2_l, i1_n;
    Double_t dt_m, dt_l;

    // momentum correction
    if ( Pmom < 0 ) Pmom = 0.;
    if ( Pmom > mom[38] ) {
        i1_m = 38;
        i2_m = 39;
        dt_m = 0.;
    } else {
        i1_m = 0;
        i2_m = 38;
        ii   = (i1_m+i2_m)/2;
        while ( ii > i1_m ) {
            if ( Pmom >= mom[ii] ) i1_m = ii;
            else                   i2_m = ii;
            ii = (i1_m+i2_m)/2;
        }
        dt_m = (Pmom - mom[i1_m])/(mom[i2_m] - mom[i1_m]);
    }

    // pathlength correction
    i1_l = (int)((Length-len[0])/0.04);
    if ( i1_l < 0  ) i1_l = 0;
    if ( i1_l > 16 ) i1_l = 16;
    i2_l = i1_l +1;
    dt_l = (Length - len[i1_l])/(len[i2_l] - len[i1_l]);
    if ( dt_l > 1. ) dt_l = 1.;

    // layer correction
    i1_n = Layer;
    if ( i1_n < 0 )  i1_n = 0;
    if ( i1_n > 19 ) i1_n = 19;


    Par[0] = (p01_m[i1_m] + dt_m*(p01_m[i2_m]-p01_m[i1_m]))*(p01_l[i1_l] + dt_l*(p01_l[i2_l]-p01_l[i1_l]))*p01_n[i1_n]
            + (c01_x[i1_l] + dt_l*(c01_x[i2_l]-c01_x[i1_l]))*(Press-0.800);
    Par[1] = (p02_m[i1_m] + dt_m*(p02_m[i2_m]-p02_m[i1_m]))*(p02_l[i1_l] + dt_l*(p02_l[i2_l]-p02_l[i1_l]))*p02_n[i1_n]
            + (c02_x[i1_l] + dt_l*(c02_x[i2_l]-c02_x[i1_l]))*(Press-0.800);
    Par[2] = (p03_m[i1_m] + dt_m*(p03_m[i2_m]-p03_m[i1_m]))*(p03_l[i1_l] + dt_l*(p03_l[i2_l]-p03_l[i1_l]))*p03_n[i1_n]
            + (c03_x[i1_l] + dt_l*(c03_x[i2_l]-c03_x[i1_l]))*(Press-0.800);
    Par[3] = (p04_m[i1_m] + dt_m*(p04_m[i2_m]-p04_m[i1_m]))*(p04_l[i1_l] + dt_l*(p04_l[i2_l]-p04_l[i1_l]))*p04_n[i1_n]
            + (c04_x[i1_l] + dt_l*(c04_x[i2_l]-c04_x[i1_l]))*(Press-0.800);
    Par[4] = (p05_m[i1_m] + dt_m*(p05_m[i2_m]-p05_m[i1_m]))*(p05_l[i1_l] + dt_l*(p05_l[i2_l]-p05_l[i1_l]))*p05_n[i1_n]
            + (c05_x[i1_l] + dt_l*(c05_x[i2_l]-c05_x[i1_l]))*(Press-0.800);
    Par[5] = (p06_m[i1_m] + dt_m*(p06_m[i2_m]-p06_m[i1_m]))*(p06_l[i1_l] + dt_l*(p06_l[i2_l]-p06_l[i1_l]))*p06_n[i1_n]
            + (c06_x[i1_l] + dt_l*(c06_x[i2_l]-c06_x[i1_l]))*(Press-0.800);
    Par[6] = (p07_m[i1_m] + dt_m*(p07_m[i2_m]-p07_m[i1_m]))*(p07_l[i1_l] + dt_l*(p07_l[i2_l]-p07_l[i1_l]))*p07_n[i1_n]
            + (c07_x[i1_l] + dt_l*(c07_x[i2_l]-c07_x[i1_l]))*(Press-0.800);
    Par[7] = (p08_m[i1_m] + dt_m*(p08_m[i2_m]-p08_m[i1_m]))*(p08_l[i1_l] + dt_l*(p08_l[i2_l]-p08_l[i1_l]))*p08_n[i1_n]
            + (c08_x[i1_l] + dt_l*(c08_x[i2_l]-c08_x[i1_l]))*(Press-0.800);
    Par[8] = (p09_m[i1_m] + dt_m*(p09_m[i2_m]-p09_m[i1_m]))*(p09_l[i1_l] + dt_l*(p09_l[i2_l]-p09_l[i1_l]))*p09_n[i1_n]
            + (c09_x[i1_l] + dt_l*(c09_x[i2_l]-c09_x[i1_l]))*(Press-0.800);
    Par[9] = (p10_m[i1_m] + dt_m*(p10_m[i2_m]-p10_m[i1_m]))*(p10_l[i1_l] + dt_l*(p10_l[i2_l]-p10_l[i1_l]))*p10_n[i1_n]
            + (c10_x[i1_l] + dt_l*(c10_x[i2_l]-c10_x[i1_l]))*(Press-0.800);
    Par[10]= (p11_m[i1_m] + dt_m*(p11_m[i2_m]-p11_m[i1_m]))*(p11_l[i1_l] + dt_l*(p11_l[i2_l]-p11_l[i1_l]))*p11_n[i1_n]
            + (c11_x[i1_l] + dt_l*(c11_x[i2_l]-c11_x[i1_l]))*(Press-0.800);
    Par[11]= 0.0;
    Par[12]= 0.0;
    Par[13]= 0.0;
    Par[14]= 0.0;


}


Double_t TrdKPDF::func_l(Double_t x, Double_t a, Double_t b, Double_t c) {
    Double_t var;
    //    if ( x < 0.0 ) x = 0.0;
    if ( a < 0.0 ) a = 0.0;
    if ( b < 1.0 ) b = 1.0;
    if ( c < 0.1 ) c = 0.1;
    var  = (x-a)/b/c;
    return pow(c,c-1)/TMath::Gamma(c)*exp(-c*(var+exp(-var)))/b;
}


Double_t TrdKPDF::func_li(Double_t x, Double_t a, Double_t b, Double_t c) {
    Double_t var;
    //    if ( x < 0.0 ) x = 0.0;
    if ( a < 0.0 ) a = 0.0;
    if ( b < 1.0 ) b = 1.0;
    if ( c < 0.1 ) c = 0.1;
    var  = c*exp(-(x-a)/b/c);
    return TMath::Gamma(c,var);
}


//==========For TRD Charge Estimation=====================================


//////////////////////////
//Added by Wei Sun
//////////////////////////

Double_t TrdKPDF::GetLikelihoodQ(double Amp){
    return  Par[0]*func_l(Amp,Par[1],Par[2],Par[3]) + Par[4]*func_l(Amp,Par[5],Par[6],Par[7]) + (1.-Par[0]-Par[4])*func_l(Amp,Par[8],Par[9],Par[10]);
}

Double_t TrdKPDF::GetLikelihoodHA(Double_t Corr){
    double Amp=3400*Corr;
    return  Par[0]*func_li(Amp,Par[1],Par[2],Par[3]) + Par[4]*func_li(Amp,Par[5],Par[6],Par[7]) + (1.-Par[0]-Par[4])*func_li(Amp,Par[8],Par[9],Par[10]);
}

Double_t TrdKPDF::GetLikelihoodLA(Double_t Corr){
    int n=(Int_t)(15*Corr);
    double v=0;
    double x;
    for(int i=0;i<n;i++){
        x = 1.0*i + 0.5;
        v += Par[0]*func_l(x,Par[1],Par[2],Par[3]) + Par[4]*func_l(x,Par[5],Par[6],Par[7]) + (1.-Par[0]-Par[4])*func_l(x,Par[8],Par[9],Par[10]);
    }
    return v;
}

/*  Old charge PDF, fit points at integer
void TrdKPDF::GetPar_Nuclei(Double_t Charge, Double_t Pmom, Double_t Length, Int_t Layer, Double_t Press){

  Int_t    ii, i1_m, i2_m, i1_l, i2_l, i1_n, i1_x, i1_c;
  Double_t dt_m, dt_l, dt_n, dt_x, dt_c;

  Double_t chrg[8]   = {0.,   1.,   4.,   9.,   16.,  25.,  36.,  49.};

  Double_t p02_c[8]  = {0.01, 0.14, 1.00, 2.56, 4.56, 7.12, 9.86, 12.3};

  Double_t p03_c[8]  = {0.05, 0.34, 1.00, 2.00, 2.91, 3.59, 4.07, 4.40};

  Double_t p04_c[8]  = {0.04, 0.65, 1.00, 1.13, 1.33, 1.56, 1.85, 2.14};

  Double_t p09_c[8]  = {0.01, 0.16, 1.00, 1.76, 2.88, 4.16, 5.63, 7.04};

  Double_t p10_c[8]  = {0.03, 0.31, 1.00, 1.36, 1.63, 1.95, 2.26, 2.56};


  Double_t mom[40]   = {0.50,  1.50,  2.50,  3.50,  4.50,  5.50,  6.50,  7.50,  8.40,  9.40,
            10.9,  12.8,  14.7,  16.6,  18.5,  21.4,  25.0,  29.0,  33.0,  37.0,
            41.5,  49.5,  57.5,  65.5,  73.5,  83.0,  99.0,  115.,  131.,  147.,
            168.,  208.,  248.,  288.,  328.,  440.,  540.,  640.,  740.,  840.};

  Double_t p01_m[40] = {0.740, 0.759, 0.784, 0.809, 0.823, 0.832, 0.837, 0.838, 0.838, 0.838,
            0.838, 0.838, 0.837, 0.835, 0.834, 0.832, 0.831, 0.830, 0.830, 0.830,
            0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830,
            0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830};

  Double_t p02_m[40] = {600.0, 530.0, 435.4, 390.9, 380.1, 377.5, 377.8, 386.4, 390.6, 395.2,
            401.9, 410.4, 418.4, 425.1, 431.6, 440.2, 449.8, 458.3, 465.8, 472.7,
            479.5, 488.9, 495.9, 501.8, 506.0, 511.5, 517.8, 521.1, 524.5, 527.0,
            529.0, 530.6, 531.8, 532.8, 533.6, 534.2, 534.4, 534.5, 534.6, 534.6};

  Double_t p03_m[40] = {350.0, 282.0, 210.0, 188.2, 180.6, 179.2, 179.6, 179.9, 180.3, 181.1,
            182.5, 183.9, 185.7, 186.5, 187.9, 190.1, 191.5, 193.8, 195.9, 197.5,
            198.9, 201.7, 204.2, 206.8, 208.7, 211.6, 215.4, 216.9, 221.0, 223.6,
            225.8, 227.6, 229.0, 230.2, 231.2, 232.0, 232.6, 233.0, 233.2, 233.3};

  Double_t p04_m[40] = {0.600, 0.590, 0.580, 0.560, 0.550, 0.540, 0.547, 0.549, 0.551, 0.556,
            0.559, 0.564, 0.570, 0.575, 0.580, 0.586, 0.590, 0.597, 0.603, 0.609,
            0.615, 0.621, 0.627, 0.633, 0.639, 0.645, 0.651, 0.657, 0.663, 0.669,
            0.675, 0.681, 0.687, 0.693, 0.699, 0.700, 0.700, 0.700, 0.700, 0.700};

  Double_t p05_m[40] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
            0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
            0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
            0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

  Double_t p06_m[40] = {500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0,
            500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0,
            500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0,
            500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0};

  Double_t p07_m[40] = {600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0,
            600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0,
            600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0,
            600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0};

  Double_t p08_m[40] = {0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500,
            0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500,
            0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500,
            0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500};

  Double_t p09_m[40] = {710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0,
            710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0,
            710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0,
            710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0};

  Double_t p10_m[40] = {860.0, 798.0, 660.1, 625.5, 618.0, 615.2, 614.0, 612.4, 612.0, 610.4,
            609.6, 607.0, 605.5, 603.5, 601.6, 602.3, 602.2, 602.2, 602.2, 602.2,
            603.0, 605.0, 609.0, 613.0, 617.0, 621.0, 624.0, 627.0, 629.0, 630.0,
            630.0, 630.0, 630.0, 630.0, 630.0, 630.0, 630.0, 630.0, 630.0, 630.0};

  Double_t p11_m[40] = {0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250,
            0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250,
            0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250,
            0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250};


  Double_t len[18]   = {0.020, 0.060, 0.100, 0.140, 0.180, 0.220, 0.260, 0.300, 0.340, 0.380,
            0.420, 0.460, 0.500, 0.540, 0.580, 0.620, 0.660, 0.700};

  Double_t p01_l[18] = {1.090, 1.090, 1.090, 1.093, 1.096, 1.101, 1.105, 1.108, 1.108, 1.105,
            1.098, 1.087, 1.072, 1.051, 1.026, 1.000, 0.964, 0.930};

  Double_t p02_l[18] = {0.190, 0.190, 0.190, 0.199, 0.225, 0.255, 0.297, 0.356, 0.425, 0.501,
            0.580, 0.666, 0.754, 0.839, 0.926, 0.989, 1.070, 1.150};

  Double_t p03_l[18] = {0.900, 0.880, 0.865, 0.857, 0.853, 0.850, 0.851, 0.854, 0.866, 0.877,
            0.883, 0.905, 0.924, 0.944, 0.962, 0.990, 1.040, 1.090};

  Double_t p04_l[18] = {0.450, 0.450, 0.460, 0.480, 0.520, 0.590, 0.640, 0.700, 0.745, 0.805,
            0.870, 0.920, 0.950, 0.980, 1.000, 1.000, 1.000, 1.000};

  Double_t p05_l[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
            0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

  Double_t p06_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

  Double_t p07_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

  Double_t p08_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

  Double_t p09_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

  Double_t p10_l[18] = {1.260, 1.243, 1.225, 1.208, 1.190, 1.172, 1.154, 1.136, 1.119, 1.101,
            1.093, 1.075, 1.057, 1.040, 1.022, 1.004, 0.986, 0.968};

  Double_t p11_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};


  Double_t p01_n[20] = {0.986, 0.987, 0.989, 0.990, 0.992, 0.993, 0.995, 0.996, 0.998, 0.999,
            1.001, 1.002, 1.004, 1.005, 1.007, 1.008, 1.010, 1.011, 1.013, 1.014};

  Double_t p02_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

  Double_t p03_n[20] = {0.985, 0.986, 0.988, 0.990, 0.991, 0.993, 0.995, 0.996, 0.998, 1.000,
            1.001, 1.003, 1.005, 1.006, 1.008, 1.010, 1.011, 1.013, 1.015, 1.016};

  Double_t p04_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

  Double_t p05_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

  Double_t p06_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

  Double_t p07_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

  Double_t p08_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

  Double_t p09_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

  Double_t p10_n[20] = {0.955, 0.960, 0.965, 0.970, 0.975, 0.980, 0.985, 0.990, 0.995, 1.000,
            1.005, 1.010, 1.015, 1.020, 1.025, 1.030, 1.035, 1.040, 1.045, 1.050};

  Double_t p11_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
            1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};


  Double_t c01_x[18] = {0.120, 0.120, 0.120, 0.120, 0.120, 0.120, 0.120, 0.120, 0.120, 0.140,
            0.160, 0.160, 0.150, 0.140, 0.120, 0.100, 0.100, 0.100};

  Double_t c02_x[18] ={-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,
               -260.0,-210.0,-160.0,-90.00,-30.00, 30.00, 80.00, 100.0};

  Double_t c03_x[18] ={-220.0,-220.0,-220.0,-220.0,-220.0,-220.0,-220.0,-220.0,-200.0,-175.0,
               -150.0,-125.0,-100.0,-80.00,-65.00,-52.00,-50.00,-50.00};

  Double_t c04_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
            0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

  Double_t c05_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
            0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

  Double_t c06_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
            0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

  Double_t c07_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
            0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

  Double_t c08_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
            0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

  Double_t c09_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
            0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

  Double_t c10_x[18] ={-580.0,-550.0,-520.0,-490.0,-460.0,-430.0,-400.0,-370.0,-340.0,-310.0,
               -280.0,-250.0,-240.0,-220.0,-210.0,-210.0,-210.0,-210.0};

  Double_t c11_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
            0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

  // Rigidity correction
  if ( Charge < 0 )      Charge *= -1.;
  if ( Charge < 1. )     Pmom   *= 0.5;
  else if ( Charge < 2.) Pmom   *= 0.5*Charge;

  i1_c = (Int_t)Charge;
  if ( i1_c > 6 ) i1_c = 6;
  dt_c = (Charge*Charge - chrg[i1_c])/(chrg[i1_c+1] - chrg[i1_c]);

  // momentum correction
  if ( Pmom < 0 ) Pmom *= -1.;
  if ( Pmom > mom[38] ) {
    i1_m = 38;
    i2_m = 39;
    dt_m = 0.;
  } else {
    i1_m = 0;
    i2_m = 38;
    ii   = (i1_m+i2_m)/2;
    while ( ii > i1_m ) {
      if ( Pmom >= mom[ii] ) i1_m = ii;
      else                   i2_m = ii;
      ii = (i1_m+i2_m)/2;
    }
    dt_m = (Pmom - mom[i1_m])/(mom[i2_m] - mom[i1_m]);
  }

  // pathlength correction
  i1_l = (int)((Length-len[0])/0.04);
  if ( i1_l < 0  ) i1_l = 0;
  if ( i1_l > 16 ) i1_l = 16;
  i2_l = i1_l +1;
  dt_l = (Length - len[i1_l])/(len[i2_l] - len[i1_l]);
  if ( dt_l > 1. ) dt_l = 1.;

  // layer correction
  i1_n = Layer;
  if ( i1_n < 0 )  i1_n = 0;
  if ( i1_n > 19 ) i1_n = 19;

  Par[0] = (p01_m[i1_m] + dt_m*(p01_m[i2_m]-p01_m[i1_m]))*(p01_l[i1_l] + dt_l*(p01_l[i2_l]-p01_l[i1_l]))*p01_n[i1_n]
         + (c01_x[i1_l] + dt_l*(c01_x[i2_l]-c01_x[i1_l]))*(Press-0.800);
  Par[1] = (p02_m[i1_m] + dt_m*(p02_m[i2_m]-p02_m[i1_m]))*(p02_l[i1_l] + dt_l*(p02_l[i2_l]-p02_l[i1_l]))*p02_n[i1_n]
         + (c02_x[i1_l] + dt_l*(c02_x[i2_l]-c02_x[i1_l]))*(Press-0.800);
  Par[2] = (p03_m[i1_m] + dt_m*(p03_m[i2_m]-p03_m[i1_m]))*(p03_l[i1_l] + dt_l*(p03_l[i2_l]-p03_l[i1_l]))*p03_n[i1_n]
         + (c03_x[i1_l] + dt_l*(c03_x[i2_l]-c03_x[i1_l]))*(Press-0.800);
  Par[3] = (p04_m[i1_m] + dt_m*(p04_m[i2_m]-p04_m[i1_m]))*(p04_l[i1_l] + dt_l*(p04_l[i2_l]-p04_l[i1_l]))*p04_n[i1_n]
         + (c04_x[i1_l] + dt_l*(c04_x[i2_l]-c04_x[i1_l]))*(Press-0.800);
  Par[4] = (p05_m[i1_m] + dt_m*(p05_m[i2_m]-p05_m[i1_m]))*(p05_l[i1_l] + dt_l*(p05_l[i2_l]-p05_l[i1_l]))*p05_n[i1_n]
         + (c05_x[i1_l] + dt_l*(c05_x[i2_l]-c05_x[i1_l]))*(Press-0.800);
  Par[5] = (p06_m[i1_m] + dt_m*(p06_m[i2_m]-p06_m[i1_m]))*(p06_l[i1_l] + dt_l*(p06_l[i2_l]-p06_l[i1_l]))*p06_n[i1_n]
         + (c06_x[i1_l] + dt_l*(c06_x[i2_l]-c06_x[i1_l]))*(Press-0.800);
  Par[6] = (p07_m[i1_m] + dt_m*(p07_m[i2_m]-p07_m[i1_m]))*(p07_l[i1_l] + dt_l*(p07_l[i2_l]-p07_l[i1_l]))*p07_n[i1_n]
         + (c07_x[i1_l] + dt_l*(c07_x[i2_l]-c07_x[i1_l]))*(Press-0.800);
  Par[7] = (p08_m[i1_m] + dt_m*(p08_m[i2_m]-p08_m[i1_m]))*(p08_l[i1_l] + dt_l*(p08_l[i2_l]-p08_l[i1_l]))*p08_n[i1_n]
         + (c08_x[i1_l] + dt_l*(c08_x[i2_l]-c08_x[i1_l]))*(Press-0.800);
  Par[8] = (p09_m[i1_m] + dt_m*(p09_m[i2_m]-p09_m[i1_m]))*(p09_l[i1_l] + dt_l*(p09_l[i2_l]-p09_l[i1_l]))*p09_n[i1_n]
         + (c09_x[i1_l] + dt_l*(c09_x[i2_l]-c09_x[i1_l]))*(Press-0.800);
  Par[9] = (p10_m[i1_m] + dt_m*(p10_m[i2_m]-p10_m[i1_m]))*(p10_l[i1_l] + dt_l*(p10_l[i2_l]-p10_l[i1_l]))*p10_n[i1_n]
         + (c10_x[i1_l] + dt_l*(c10_x[i2_l]-c10_x[i1_l]))*(Press-0.800);
  Par[10]= (p11_m[i1_m] + dt_m*(p11_m[i2_m]-p11_m[i1_m]))*(p11_l[i1_l] + dt_l*(p11_l[i2_l]-p11_l[i1_l]))*p11_n[i1_n]
         + (c11_x[i1_l] + dt_l*(c11_x[i2_l]-c11_x[i1_l]))*(Press-0.800);

  Par[1] *= p02_c[i1_c] + dt_c*(p02_c[i1_c+1]-p02_c[i1_c]);
  Par[2] *= p03_c[i1_c] + dt_c*(p03_c[i1_c+1]-p03_c[i1_c]);
  Par[3] *= p04_c[i1_c] + dt_c*(p04_c[i1_c+1]-p04_c[i1_c]);
  Par[8] *= p09_c[i1_c] + dt_c*(p09_c[i1_c+1]-p09_c[i1_c]);
  Par[9] *= p10_c[i1_c] + dt_c*(p10_c[i1_c+1]-p10_c[i1_c]);
}
*/

void TrdKPDF::Init_Nuclei()
{
    Double_t _ichrg[8]   = {0.,   1.,   4.,   9.,   16.,  25.,  36.,  49.};
    Double_t _ip02_c[8]  = {0.01, 0.14, 1.00, 2.56, 4.56, 7.12, 9.86, 12.3};
    Double_t _ip03_c[8]  = {0.05, 0.34, 1.00, 2.00, 2.91, 3.59, 4.07, 4.40};
    Double_t _ip04_c[8]  = {0.04, 0.65, 1.00, 1.13, 1.33, 1.56, 1.85, 2.14};
    Double_t _ip09_c[8]  = {0.01, 0.16, 1.00, 1.76, 2.88, 4.16, 5.63, 7.04};
    Double_t _ip10_c[8]  = {0.03, 0.31, 1.00, 1.36, 1.63, 1.95, 2.26, 2.56};

    Double_t _chrg[80]  = {0.00, 0.01, 0.04, 0.09, 0.16, 0.25, 0.36, 0.49, 0.64, 0.81,
                           1.00, 1.21, 1.44, 1.69, 1.96, 2.25, 2.56, 2.89, 3.24, 3.61,
                           4.00, 4.41, 4.84, 5.29, 5.76, 6.25, 6.76, 7.29, 7.84, 8.41,
                           9.00, 9.61, 10.2, 10.9, 11.6, 12.3, 13.0, 13.7, 14.4, 15.2,
                           16.0, 16.8, 17.6, 18.5, 19.4, 20.3, 21.2, 22.1, 23.0, 24.0,
                           25.0, 26.0, 27.0, 28.1, 29.2, 30.3, 31.4, 32.5, 33.6, 34.8,
                           36.0, 37.2, 38.4, 39.7, 41.0, 42.3, 43.6, 44.9, 46.2, 47.6,
                           49.0, 50.4, 51.8, 53.3, 54.8, 56.3, 57.8, 59.3, 60.8, 62.4};

    Double_t _p02_c[80] = {0.01, 0.01, 0.01, 0.02, 0.03, 0.05, 0.07, 0.09, 0.12, 0.14,
                           0.18, 0.22, 0.27, 0.34, 0.40, 0.49, 0.58, 0.68, 0.78, 0.89,
                           1.00, 1.11, 1.24, 1.38, 1.52, 1.65, 1.80, 1.97, 2.13, 2.30,
                           2.52, 2.67, 2.84, 3.05, 3.26, 3.47, 3.68, 3.88, 4.09, 4.32,
                           4.56, 4.79, 5.03, 5.28, 5.54, 5.81, 6.06, 6.32, 6.57, 6.88,
                           7.12, 7.38, 7.65, 7.93, 8.21, 8.48, 8.75, 9.03, 9.29, 9.58,
                           9.86, 10.1, 10.4, 10.7, 11.0, 11.2, 11.5, 11.8, 12.0, 12.3,
                           12.6, 12.9, 13.1, 13.4, 13.7, 13.9, 14.2, 14.4, 14.7, 14.9};

    Double_t _p03_c[80] = {0.05, 0.05, 0.06, 0.08, 0.10, 0.12, 0.16, 0.20, 0.24, 0.29,
                           0.34, 0.39, 0.45, 0.52, 0.58, 0.64, 0.70, 0.77, 0.85, 0.92,
                           1.00, 1.08, 1.17, 1.27, 1.37, 1.47, 1.57, 1.67, 1.78, 1.89,
                           2.00, 2.10, 2.20, 2.30, 2.40, 2.49, 2.58, 2.66, 2.74, 2.83,
                           2.91, 2.99, 3.07, 3.15, 3.22, 3.28, 3.34, 3.41, 3.47, 3.53,
                           3.59, 3.65, 3.71, 3.76, 3.81, 3.86, 3.90, 3.94, 3.98, 4.03,
                           4.07, 4.11, 4.15, 4.19, 4.22, 4.25, 4.28, 4.31, 4.34, 4.37,
                           4.40, 4.43, 4.45, 4.48, 4.51, 4.53, 4.55, 4.57, 4.59, 4.61};

    Double_t _p04_c[80] = {0.04, 0.05, 0.07, 0.11, 0.15, 0.22, 0.28, 0.37, 0.46, 0.56,
                           0.65, 0.71, 0.75, 0.79, 0.82, 0.85, 0.88, 0.91, 0.94, 0.97,
                           1.00, 1.02, 1.04, 1.06, 1.07, 1.08, 1.10, 1.11, 1.13, 1.14,
                           1.15, 1.17, 1.18, 1.20, 1.22, 1.23, 1.25, 1.27, 1.29, 1.31,
                           1.33, 1.35, 1.37, 1.39, 1.42, 1.44, 1.46, 1.48, 1.51, 1.53,
                           1.56, 1.59, 1.61, 1.63, 1.66, 1.68, 1.71, 1.73, 1.76, 1.79,
                           1.82, 1.85, 1.88, 1.91, 1.94, 1.98, 2.01, 2.04, 2.07, 2.11,
                           2.14, 2.17, 2.20, 2.23, 2.26, 2.30, 2.33, 2.36, 2.38, 2.41};

    Double_t _p09_c[80] = {0.01, 0.01, 0.02, 0.04, 0.06, 0.08, 0.12, 0.16, 0.20, 0.25,
                           0.30, 0.36, 0.41, 0.48, 0.54, 0.62, 0.69, 0.76, 0.84, 0.92,
                           1.00, 1.09, 1.17, 1.26, 1.34, 1.43, 1.53, 1.63, 1.71, 1.80,
                           1.90, 2.00, 2.10, 2.21, 2.32, 2.43, 2.53, 2.64, 2.75, 2.86,
                           2.98, 3.10, 3.22, 3.35, 3.47, 3.60, 3.73, 3.86, 3.98, 4.12,
                           4.26, 4.39, 4.52, 4.66, 4.79, 4.93, 5.07, 5.21, 5.35, 5.49,
                           5.63, 5.77, 5.91, 6.05, 6.20, 6.34, 6.48, 6.62, 6.75, 6.89,
                           7.04, 7.18, 7.32, 7.46, 7.60, 7.74, 7.87, 8.00, 8.13, 8.26};

    Double_t _p10_c[80] = {0.03, 0.03, 0.04, 0.06, 0.08, 0.10, 0.13, 0.17, 0.21, 0.26,
                           0.31, 0.37, 0.42, 0.49, 0.56, 0.63, 0.70, 0.78, 0.86, 0.93,
                           1.00, 1.06, 1.11, 1.15, 1.18, 1.21, 1.24, 1.27, 1.30, 1.33,
                           1.36, 1.39, 1.42, 1.45, 1.47, 1.50, 1.53, 1.55, 1.58, 1.61,
                           1.63, 1.66, 1.69, 1.72, 1.75, 1.79, 1.82, 1.85, 1.88, 1.92,
                           1.95, 1.98, 2.01, 2.04, 2.08, 2.11, 2.14, 2.17, 2.20, 2.23,
                           2.26, 2.29, 2.32, 2.35, 2.38, 2.41, 2.44, 2.47, 2.50, 2.53,
                           2.56, 2.59, 2.62, 2.65, 2.68, 2.71, 2.74, 2.77, 2.80, 2.83};


    Double_t _mom[40]   = {0.50,  1.50,  2.50,  3.50,  4.50,  5.50,  6.50,  7.50,  8.40,  9.40,
                           10.9,  12.8,  14.7,  16.6,  18.5,  21.4,  25.0,  29.0,  33.0,  37.0,
                           41.5,  49.5,  57.5,  65.5,  73.5,  83.0,  99.0,  115.,  131.,  147.,
                           168.,  208.,  248.,  288.,  328.,  440.,  540.,  640.,  740.,  840.};

    Double_t _p01_m[40] = {0.740, 0.759, 0.784, 0.809, 0.823, 0.832, 0.837, 0.838, 0.838, 0.838,
                           0.838, 0.838, 0.837, 0.835, 0.834, 0.832, 0.831, 0.830, 0.830, 0.830,
                           0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830,
                           0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830, 0.830};

    Double_t _p02_m[40] = {600.0, 530.0, 435.4, 390.9, 380.1, 377.5, 377.8, 386.4, 390.6, 395.2,
                           401.9, 410.4, 418.4, 425.1, 431.6, 440.2, 449.8, 458.3, 465.8, 472.7,
                           479.5, 488.9, 495.9, 501.8, 506.0, 511.5, 517.8, 521.1, 524.5, 527.0,
                           529.0, 530.6, 531.8, 532.8, 533.6, 534.2, 534.4, 534.5, 534.6, 534.6};

    Double_t _p03_m[40] = {350.0, 282.0, 210.0, 188.2, 180.6, 179.2, 179.6, 179.9, 180.3, 181.1,
                           182.5, 183.9, 185.7, 186.5, 187.9, 190.1, 191.5, 193.8, 195.9, 197.5,
                           198.9, 201.7, 204.2, 206.8, 208.7, 211.6, 215.4, 216.9, 221.0, 223.6,
                           225.8, 227.6, 229.0, 230.2, 231.2, 232.0, 232.6, 233.0, 233.2, 233.3};

    Double_t _p04_m[40] = {0.600, 0.590, 0.580, 0.560, 0.550, 0.540, 0.547, 0.549, 0.551, 0.556,
                           0.559, 0.564, 0.570, 0.575, 0.580, 0.586, 0.590, 0.597, 0.603, 0.609,
                           0.615, 0.621, 0.627, 0.633, 0.639, 0.645, 0.651, 0.657, 0.663, 0.669,
                           0.675, 0.681, 0.687, 0.693, 0.699, 0.700, 0.700, 0.700, 0.700, 0.700};

    Double_t _p05_m[40] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _p06_m[40] = {500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0,
                           500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0,
                           500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0,
                           500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0};

    Double_t _p07_m[40] = {600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0,
                           600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0,
                           600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0,
                           600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0};

    Double_t _p08_m[40] = {0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500,
                           0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500,
                           0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500,
                           0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500, 0.500};

    Double_t _p09_m[40] = {710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0,
                           710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0,
                           710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0,
                           710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0, 710.0};

    Double_t _p10_m[40] = {860.0, 798.0, 660.1, 625.5, 618.0, 615.2, 614.0, 612.4, 612.0, 610.4,
                           609.6, 607.0, 605.5, 603.5, 601.6, 602.3, 602.2, 602.2, 602.2, 602.2,
                           603.0, 605.0, 609.0, 613.0, 617.0, 621.0, 624.0, 627.0, 629.0, 630.0,
                           630.0, 630.0, 630.0, 630.0, 630.0, 630.0, 630.0, 630.0, 630.0, 630.0};

    Double_t _p11_m[40] = {0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250,
                           0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250,
                           0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250,
                           0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250, 0.250};


    Double_t _len[18]   = {0.020, 0.060, 0.100, 0.140, 0.180, 0.220, 0.260, 0.300, 0.340, 0.380,
                           0.420, 0.460, 0.500, 0.540, 0.580, 0.620, 0.660, 0.700};

    Double_t _p01_l[18] = {1.090, 1.090, 1.090, 1.093, 1.096, 1.101, 1.105, 1.108, 1.108, 1.105,
                           1.098, 1.087, 1.072, 1.051, 1.026, 1.000, 0.964, 0.930};

    Double_t _p02_l[18] = {0.190, 0.190, 0.190, 0.199, 0.225, 0.255, 0.297, 0.356, 0.425, 0.501,
                           0.580, 0.666, 0.754, 0.839, 0.926, 0.989, 1.070, 1.150};

    Double_t _p03_l[18] = {0.900, 0.880, 0.865, 0.857, 0.853, 0.850, 0.851, 0.854, 0.866, 0.877,
                           0.883, 0.905, 0.924, 0.944, 0.962, 0.990, 1.040, 1.090};

    Double_t _p04_l[18] = {0.450, 0.450, 0.460, 0.480, 0.520, 0.590, 0.640, 0.700, 0.745, 0.805,
                           0.870, 0.920, 0.950, 0.980, 1.000, 1.000, 1.000, 1.000};

    Double_t _p05_l[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _p06_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p07_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p08_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p09_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p10_l[18] = {1.260, 1.243, 1.225, 1.208, 1.190, 1.172, 1.154, 1.136, 1.119, 1.101,
                           1.093, 1.075, 1.057, 1.040, 1.022, 1.004, 0.986, 0.968};

    Double_t _p11_l[18] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};


    Double_t _p01_n[20] = {0.986, 0.987, 0.989, 0.990, 0.992, 0.993, 0.995, 0.996, 0.998, 0.999,
                           1.001, 1.002, 1.004, 1.005, 1.007, 1.008, 1.010, 1.011, 1.013, 1.014};

    Double_t _p02_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p03_n[20] = {0.985, 0.986, 0.988, 0.990, 0.991, 0.993, 0.995, 0.996, 0.998, 1.000,
                           1.001, 1.003, 1.005, 1.006, 1.008, 1.010, 1.011, 1.013, 1.015, 1.016};

    Double_t _p04_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p05_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p06_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p07_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p08_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p09_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};

    Double_t _p10_n[20] = {0.955, 0.960, 0.965, 0.970, 0.975, 0.980, 0.985, 0.990, 0.995, 1.000,
                           1.005, 1.010, 1.015, 1.020, 1.025, 1.030, 1.035, 1.040, 1.045, 1.050};

    Double_t _p11_n[20] = {1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000,
                           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000};


    Double_t _c01_x[18] = {0.120, 0.120, 0.120, 0.120, 0.120, 0.120, 0.120, 0.120, 0.120, 0.140,
                           0.160, 0.160, 0.150, 0.140, 0.120, 0.100, 0.100, 0.100};

    Double_t _c02_x[18] ={-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,-300.0,
                          -260.0,-210.0,-160.0,-90.00,-30.00, 30.00, 80.00, 100.0};

    Double_t _c03_x[18] ={-220.0,-220.0,-220.0,-220.0,-220.0,-220.0,-220.0,-220.0,-200.0,-175.0,
                          -150.0,-125.0,-100.0,-80.00,-65.00,-52.00,-50.00,-50.00};

    Double_t _c04_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c05_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c06_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c07_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c08_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c09_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};

    Double_t _c10_x[18] ={-580.0,-550.0,-520.0,-490.0,-460.0,-430.0,-400.0,-370.0,-340.0,-310.0,
                          -280.0,-250.0,-240.0,-220.0,-210.0,-210.0,-210.0,-210.0};

    Double_t _c11_x[18] = {0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,
                           0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000};


    Double_t _p01_b[31] = {1.399, 1.3867, 1.35913, 1.34042, 1.30968, 1.28553, 1.26026, 1.24748,
    			   1.22578, 1.2015, 1.17804, 1.15815, 1.14074, 1.12598, 1.11076, 1.09702,
		           1.08546, 1.07747, 1.06761, 1.05813, 1.05229, 1.04607, 1.0398, 1.034,
		           1.02801, 1.02337, 1.01774, 1.01158, 1.00564, 1.00098, 1};

    gs02 = new TSpline3("gs02",_ichrg,_ip02_c,8);
    gs03 = new TSpline3("gs03",_ichrg,_ip03_c,8);
    gs04 = new TSpline3("gs04",_ichrg,_ip04_c,8);
    gs09 = new TSpline3("gs09",_ichrg,_ip09_c,8);
    gs10 = new TSpline3("gs10",_ichrg,_ip10_c,8);

    memcpy(ichrg,_ichrg,sizeof(Double_t)*8);
    memcpy(ip02_c,_ip02_c,sizeof(Double_t)*8);
    memcpy(ip03_c,_ip03_c,sizeof(Double_t)*8);
    memcpy(ip04_c,_ip04_c,sizeof(Double_t)*8);
    memcpy(ip09_c,_ip09_c,sizeof(Double_t)*8);
    memcpy(ip10_c,_ip10_c,sizeof(Double_t)*8);

    memcpy(chrg,_chrg,sizeof(Double_t)*80);
    memcpy(p02_c,_p02_c,sizeof(Double_t)*80);
    memcpy(p03_c,_p03_c,sizeof(Double_t)*80);
    memcpy(p04_c,_p04_c,sizeof(Double_t)*80);
    memcpy(p09_c,_p09_c,sizeof(Double_t)*80);
    memcpy(p10_c,_p10_c,sizeof(Double_t)*80);

    memcpy(mom,_mom,sizeof(Double_t)*40);
    memcpy(p01_m,_p01_m,sizeof(Double_t)*40);
    memcpy(p02_m,_p02_m,sizeof(Double_t)*40);
    memcpy(p03_m,_p03_m,sizeof(Double_t)*40);
    memcpy(p04_m,_p04_m,sizeof(Double_t)*40);
    memcpy(p05_m,_p05_m,sizeof(Double_t)*40);
    memcpy(p06_m,_p06_m,sizeof(Double_t)*40);
    memcpy(p07_m,_p07_m,sizeof(Double_t)*40);
    memcpy(p08_m,_p08_m,sizeof(Double_t)*40);
    memcpy(p09_m,_p09_m,sizeof(Double_t)*40);
    memcpy(p10_m,_p10_m,sizeof(Double_t)*40);
    memcpy(p11_m,_p11_m,sizeof(Double_t)*40);

    memcpy(len,_len,sizeof(Double_t)*18);
    memcpy(p01_l,_p01_l,sizeof(Double_t)*18);
    memcpy(p02_l,_p02_l,sizeof(Double_t)*18);
    memcpy(p03_l,_p03_l,sizeof(Double_t)*18);
    memcpy(p04_l,_p04_l,sizeof(Double_t)*18);
    memcpy(p05_l,_p05_l,sizeof(Double_t)*18);
    memcpy(p06_l,_p06_l,sizeof(Double_t)*18);
    memcpy(p07_l,_p07_l,sizeof(Double_t)*18);
    memcpy(p08_l,_p08_l,sizeof(Double_t)*18);
    memcpy(p09_l,_p09_l,sizeof(Double_t)*18);
    memcpy(p10_l,_p10_l,sizeof(Double_t)*18);
    memcpy(p11_l,_p11_l,sizeof(Double_t)*18);


    memcpy(p01_n,_p01_n,sizeof(Double_t)*20);
    memcpy(p02_n,_p02_n,sizeof(Double_t)*20);
    memcpy(p03_n,_p03_n,sizeof(Double_t)*20);
    memcpy(p04_n,_p04_n,sizeof(Double_t)*20);
    memcpy(p05_n,_p05_n,sizeof(Double_t)*20);
    memcpy(p06_n,_p06_n,sizeof(Double_t)*20);
    memcpy(p07_n,_p07_n,sizeof(Double_t)*20);
    memcpy(p08_n,_p08_n,sizeof(Double_t)*20);
    memcpy(p09_n,_p09_n,sizeof(Double_t)*20);
    memcpy(p10_n,_p10_n,sizeof(Double_t)*20);
    memcpy(p11_n,_p11_n,sizeof(Double_t)*20);

    memcpy(c01_x,_c01_x,sizeof(Double_t)*18);
    memcpy(c02_x,_c02_x,sizeof(Double_t)*18);
    memcpy(c03_x,_c03_x,sizeof(Double_t)*18);
    memcpy(c04_x,_c04_x,sizeof(Double_t)*18);
    memcpy(c05_x,_c05_x,sizeof(Double_t)*18);
    memcpy(c06_x,_c06_x,sizeof(Double_t)*18);
    memcpy(c07_x,_c07_x,sizeof(Double_t)*18);
    memcpy(c08_x,_c08_x,sizeof(Double_t)*18);
    memcpy(c09_x,_c09_x,sizeof(Double_t)*18);
    memcpy(c10_x,_c10_x,sizeof(Double_t)*18);
    memcpy(c11_x,_c11_x,sizeof(Double_t)*18);

    memcpy(p01_b,_p01_b,sizeof(Double_t)*31);
}

void TrdKPDF::GetPar_Nuclei(Double_t Charge, Double_t Pmom, Double_t Length, Int_t Layer, Double_t Press, Double_t Beta){

    Int_t    ii, i1_m, i2_m, i1_l, i2_l, i1_n, i1_c;
    Double_t dt_m, dt_l, dt_c;

    //Beta correction
    if(Beta<0) Beta=Beta*(-1);
    if(Beta>1) Beta=1;
    if(Beta<0.4) Beta=0.4;
    int ib = (int)((Beta-0.4)*50);
    double BetaCorrFactor;
    if(Beta==1) BetaCorrFactor=1;
    else BetaCorrFactor = p01_b[ib]+(p01_b[ib+1]-p01_b[ib])/0.02*(Beta-0.4-ib*0.02);
    Charge=Charge*BetaCorrFactor;

    // Rigidity correction 
    if ( Charge < 0 )      Charge *= -1.;
    if ( Charge < 1. )     Pmom   *= 2.0;
    else if ( Charge < 2.) Pmom   *= (3-Charge);

    // momentum correction
    if ( Pmom < 0 ) Pmom *= -1.;
    if ( Pmom > mom[38] ) {
        i1_m = 38;
        i2_m = 39;
        dt_m = 0.;
    } else {
        i1_m = 0;
        i2_m = 38;
        ii   = (i1_m+i2_m)/2;
        while ( ii > i1_m ) {
            if ( Pmom >= mom[ii] ) i1_m = ii;
            else                   i2_m = ii;
            ii = (i1_m+i2_m)/2;
        }
        dt_m = (Pmom - mom[i1_m])/(mom[i2_m] - mom[i1_m]);
    }

    // pathlength correction
    i1_l = (int)((Length-len[0])/0.04);
    if ( i1_l < 0  ) i1_l = 0;
    if ( i1_l > 16 ) i1_l = 16;
    i2_l = i1_l +1;
    dt_l = (Length - len[i1_l])/(len[i2_l] - len[i1_l]);
    if ( dt_l > 1. ) dt_l = 1.;

    // layer correction
    i1_n = Layer;
    if ( i1_n < 0 )  i1_n = 0;
    if ( i1_n > 19 ) i1_n = 19;

    Par[0] = (p01_m[i1_m] + dt_m*(p01_m[i2_m]-p01_m[i1_m]))*(p01_l[i1_l] + dt_l*(p01_l[i2_l]-p01_l[i1_l]))*p01_n[i1_n]
            + (c01_x[i1_l] + dt_l*(c01_x[i2_l]-c01_x[i1_l]))*(Press-0.800);
    Par[1] = (p02_m[i1_m] + dt_m*(p02_m[i2_m]-p02_m[i1_m]))*(p02_l[i1_l] + dt_l*(p02_l[i2_l]-p02_l[i1_l]))*p02_n[i1_n]
            + (c02_x[i1_l] + dt_l*(c02_x[i2_l]-c02_x[i1_l]))*(Press-0.800);
    Par[2] = (p03_m[i1_m] + dt_m*(p03_m[i2_m]-p03_m[i1_m]))*(p03_l[i1_l] + dt_l*(p03_l[i2_l]-p03_l[i1_l]))*p03_n[i1_n]
            + (c03_x[i1_l] + dt_l*(c03_x[i2_l]-c03_x[i1_l]))*(Press-0.800);
    Par[3] = (p04_m[i1_m] + dt_m*(p04_m[i2_m]-p04_m[i1_m]))*(p04_l[i1_l] + dt_l*(p04_l[i2_l]-p04_l[i1_l]))*p04_n[i1_n]
            + (c04_x[i1_l] + dt_l*(c04_x[i2_l]-c04_x[i1_l]))*(Press-0.800);
    Par[4] = (p05_m[i1_m] + dt_m*(p05_m[i2_m]-p05_m[i1_m]))*(p05_l[i1_l] + dt_l*(p05_l[i2_l]-p05_l[i1_l]))*p05_n[i1_n]
            + (c05_x[i1_l] + dt_l*(c05_x[i2_l]-c05_x[i1_l]))*(Press-0.800);
    Par[5] = (p06_m[i1_m] + dt_m*(p06_m[i2_m]-p06_m[i1_m]))*(p06_l[i1_l] + dt_l*(p06_l[i2_l]-p06_l[i1_l]))*p06_n[i1_n]
            + (c06_x[i1_l] + dt_l*(c06_x[i2_l]-c06_x[i1_l]))*(Press-0.800);
    Par[6] = (p07_m[i1_m] + dt_m*(p07_m[i2_m]-p07_m[i1_m]))*(p07_l[i1_l] + dt_l*(p07_l[i2_l]-p07_l[i1_l]))*p07_n[i1_n]
            + (c07_x[i1_l] + dt_l*(c07_x[i2_l]-c07_x[i1_l]))*(Press-0.800);
    Par[7] = (p08_m[i1_m] + dt_m*(p08_m[i2_m]-p08_m[i1_m]))*(p08_l[i1_l] + dt_l*(p08_l[i2_l]-p08_l[i1_l]))*p08_n[i1_n]
            + (c08_x[i1_l] + dt_l*(c08_x[i2_l]-c08_x[i1_l]))*(Press-0.800);
    Par[8] = (p09_m[i1_m] + dt_m*(p09_m[i2_m]-p09_m[i1_m]))*(p09_l[i1_l] + dt_l*(p09_l[i2_l]-p09_l[i1_l]))*p09_n[i1_n]
            + (c09_x[i1_l] + dt_l*(c09_x[i2_l]-c09_x[i1_l]))*(Press-0.800);
    Par[9] = (p10_m[i1_m] + dt_m*(p10_m[i2_m]-p10_m[i1_m]))*(p10_l[i1_l] + dt_l*(p10_l[i2_l]-p10_l[i1_l]))*p10_n[i1_n]
            + (c10_x[i1_l] + dt_l*(c10_x[i2_l]-c10_x[i1_l]))*(Press-0.800);
    Par[10]= (p11_m[i1_m] + dt_m*(p11_m[i2_m]-p11_m[i1_m]))*(p11_l[i1_l] + dt_l*(p11_l[i2_l]-p11_l[i1_l]))*p11_n[i1_n]
            + (c11_x[i1_l] + dt_l*(c11_x[i2_l]-c11_x[i1_l]))*(Press-0.800);

    if(Charge<2)
    {
      i1_c = (Int_t)(10.*Charge);
      dt_c = (Charge*Charge - chrg[i1_c])/(chrg[i1_c+1] - chrg[i1_c]);
      Par[1] *= p02_c[i1_c] + dt_c*(p02_c[i1_c+1]-p02_c[i1_c]);
      Par[2] *= p03_c[i1_c] + dt_c*(p03_c[i1_c+1]-p03_c[i1_c]);
      Par[3] *= p04_c[i1_c] + dt_c*(p04_c[i1_c+1]-p04_c[i1_c]);
      Par[8] *= p09_c[i1_c] + dt_c*(p09_c[i1_c+1]-p09_c[i1_c]);
      Par[9] *= p10_c[i1_c] + dt_c*(p10_c[i1_c+1]-p10_c[i1_c]);
    }
    else if(Charge<=7 && Charge>=2)
    {
      Par[1] *= gs02->Eval(Charge*Charge);
      Par[2] *= gs03->Eval(Charge*Charge);
      Par[3] *= gs04->Eval(Charge*Charge);
      Par[8] *= gs09->Eval(Charge*Charge);
      Par[9] *= gs10->Eval(Charge*Charge);
    }
    else
    {
      dt_c = (Charge*Charge - ichrg[6])/(ichrg[7] - ichrg[6]);
      Par[1] *= ip02_c[6] + dt_c*(ip02_c[7]-ip02_c[6]);
      Par[2] *= ip03_c[6] + dt_c*(ip03_c[7]-ip03_c[6]);
      Par[3] *= ip04_c[6] + dt_c*(ip04_c[7]-ip04_c[6]);
      Par[8] *= ip09_c[6] + dt_c*(ip09_c[7]-ip09_c[6]);
      Par[9] *= ip10_c[6] + dt_c*(ip10_c[7]-ip10_c[6]);
    }
    
}

Double_t TrdKPDF::GetLikelihoodDR(Double_t DAmpL,Double_t Charge,Double_t Rigidity)
{
    double PDFValue,PDFNormalization;
    double Par1c,Par2c,Par3c,Par4c=0,Par5c,Par6c,Par7c;

    if(Charge<0) Charge=-Charge;
    if(Rigidity<0) Rigidity=-Rigidity;

    //Rigidity correction and charge PDF for Z>=3, fit points: 3 to 6, 8, 10, 12, 14, 20, 26
    static const double p1r[10]={0.49, 0.48, 0.46, 0.410, 0.390, 0.350, 0.32, 0.31, 0.2, 0.18};
    static const double p2r[10]={0.20, 0.20, 0.19, 0.165, 0.155, 0.145, 0.13, 0.13, 0.1, 0.08};

    static const double p1c[10]={88.84,  189.8,  348.5,  528.9,  988.7,  1614,   2510,   3652,     7941,     13199     };
    static const double p2c[10]={73.39,  107.9,  137.2,  138.3,  158.2,  205.4,  246.4,  280,      400.9,    449.6     };
    static const double p3c[10]={0.618,  0.7243, 1.034,  1.667,  2.838,  3.524,  4.943,  6.9,      8.112,    10.56     };
    static const double p4c[10]={0.9529, 0.9629, 0.9705, 0.9962, 0.9994, 0.9996, 0.9999, 0.999995, 0.999999, 0.99999999};
    static double p5c[10]={0,      0,      0,      0,      0,      0,      0,      0,        0,        0         };
    static const double p6c[10]={453.6,  508.3,  550.0,  625.4,  863.1,  1220.2, 1660,   3074,     23140,    63140     };
    static double p7c[10]={0,      0,      0,      0,      0,      0,      0,      0,        0,        0         };

    for(int i=0;i<10;i++)
    {
        p5c[i]=2*p1c[i];
        p7c[i]=0.2;
    }

    double Par1r=0,Par2r=0;
    if(Charge<3)
    {
        ;
    }
    else if(Charge<4)
    {
        Par1r=p1r[0]+(p1r[1]-p1r[0])*(Charge-3)/1;
        Par2r=p2r[0]+(p2r[1]-p2r[0])*(Charge-3)/1;

        Par1c=p1c[0]+(p1c[1]-p1c[0])*(Charge-3)/1;
        Par2c=p2c[0]+(p2c[1]-p2c[0])*(Charge-3)/1;
        Par3c=p3c[0]+(p3c[1]-p3c[0])*(Charge-3)/1;
        Par4c=p4c[0]+(p4c[1]-p4c[0])*(Charge-3)/1;
        Par5c=p5c[0]+(p5c[1]-p5c[0])*(Charge-3)/1;
        Par6c=p6c[0]+(p6c[1]-p6c[0])*(Charge-3)/1;
        Par7c=p7c[0]+(p7c[1]-p7c[0])*(Charge-3)/1;
    }
    else if(Charge<5)
    {
        Par1r=p1r[1]+(p1r[2]-p1r[1])*(Charge-4)/1;
        Par2r=p2r[1]+(p2r[2]-p2r[1])*(Charge-4)/1;

        Par1c=p1c[1]+(p1c[2]-p1c[1])*(Charge-4)/1;
        Par2c=p2c[1]+(p2c[2]-p2c[1])*(Charge-4)/1;
        Par3c=p3c[1]+(p3c[2]-p3c[1])*(Charge-4)/1;
        Par4c=p4c[1]+(p4c[2]-p4c[1])*(Charge-4)/1;
        Par5c=p5c[1]+(p5c[2]-p5c[1])*(Charge-4)/1;
        Par6c=p6c[1]+(p6c[2]-p6c[1])*(Charge-4)/1;
        Par7c=p7c[1]+(p7c[2]-p7c[1])*(Charge-4)/1;
    }
    else if(Charge<6)
    {
        Par1r=p1r[2]+(p1r[3]-p1r[2])*(Charge-5)/1;
        Par2r=p2r[2]+(p2r[3]-p2r[2])*(Charge-5)/1;

        Par1c=p1c[2]+(p1c[3]-p1c[2])*(Charge-5)/1;
        Par2c=p2c[2]+(p2c[3]-p2c[2])*(Charge-5)/1;
        Par3c=p3c[2]+(p3c[3]-p3c[2])*(Charge-5)/1;
        Par4c=p4c[2]+(p4c[3]-p4c[2])*(Charge-5)/1;
        Par5c=p5c[2]+(p5c[3]-p5c[2])*(Charge-5)/1;
        Par6c=p6c[2]+(p6c[3]-p6c[2])*(Charge-5)/1;
        Par7c=p7c[2]+(p7c[3]-p7c[2])*(Charge-5)/1;
    }
    else if(Charge<8)
    {
        Par1r=p1r[3]+(p1r[4]-p1r[3])*(Charge-6)/2;
        Par2r=p2r[3]+(p2r[4]-p2r[3])*(Charge-6)/2;

        Par1c=p1c[3]+(p1c[4]-p1c[3])*(Charge-6)/2;
        Par2c=p2c[3]+(p2c[4]-p2c[3])*(Charge-6)/2;
        Par3c=p3c[3]+(p3c[4]-p3c[3])*(Charge-6)/2;
        Par4c=p4c[3]+(p4c[4]-p4c[3])*(Charge-6)/2;
        Par5c=p5c[3]+(p5c[4]-p5c[3])*(Charge-6)/2;
        Par6c=p6c[3]+(p6c[4]-p6c[3])*(Charge-6)/2;
        Par7c=p7c[3]+(p7c[4]-p7c[3])*(Charge-6)/2;
    }
    else if(Charge<10)
    {
        Par1r=p1r[4]+(p1r[5]-p1r[4])*(Charge-8)/2;
        Par2r=p2r[4]+(p2r[5]-p2r[4])*(Charge-8)/2;

        Par1c=p1c[4]+(p1c[5]-p1c[4])*(Charge-8)/2;
        Par2c=p2c[4]+(p2c[5]-p2c[4])*(Charge-8)/2;
        Par3c=p3c[4]+(p3c[5]-p3c[4])*(Charge-8)/2;
        Par4c=p4c[4]+(p4c[5]-p4c[4])*(Charge-8)/2;
        Par5c=p5c[4]+(p5c[5]-p5c[4])*(Charge-8)/2;
        Par6c=p6c[4]+(p6c[5]-p6c[4])*(Charge-8)/2;
        Par7c=p7c[4]+(p7c[5]-p7c[4])*(Charge-8)/2;
    }
    else if(Charge<12)
    {
        Par1r=p1r[5]+(p1r[6]-p1r[5])*(Charge-10)/2;
        Par2r=p2r[5]+(p2r[6]-p2r[5])*(Charge-10)/2;

        Par1c=p1c[5]+(p1c[6]-p1c[5])*(Charge-10)/2;
        Par2c=p2c[5]+(p2c[6]-p2c[5])*(Charge-10)/2;
        Par3c=p3c[5]+(p3c[6]-p3c[5])*(Charge-10)/2;
        Par4c=p4c[5]+(p4c[6]-p4c[5])*(Charge-10)/2;
        Par5c=p5c[5]+(p5c[6]-p5c[5])*(Charge-10)/2;
        Par6c=p6c[5]+(p6c[6]-p6c[5])*(Charge-10)/2;
        Par7c=p7c[5]+(p7c[6]-p7c[5])*(Charge-10)/2;
    }
    else if(Charge<14)
    {
        Par1r=p1r[6]+(p1r[7]-p1r[6])*(Charge-12)/2;
        Par2r=p2r[6]+(p2r[7]-p2r[6])*(Charge-12)/2;

        Par1c=p1c[6]+(p1c[7]-p1c[6])*(Charge-12)/2;
        Par2c=p2c[6]+(p2c[7]-p2c[6])*(Charge-12)/2;
        Par3c=p3c[6]+(p3c[7]-p3c[6])*(Charge-12)/2;
        Par4c=p4c[6]+(p4c[7]-p4c[6])*(Charge-12)/2;
        Par5c=p5c[6]+(p5c[7]-p5c[6])*(Charge-12)/2;
        Par6c=p6c[6]+(p6c[7]-p6c[6])*(Charge-12)/2;
        Par7c=p7c[6]+(p7c[7]-p7c[6])*(Charge-12)/2;
    }
    else if(Charge<20)
    {
        Par1r=p1r[7]+(p1r[8]-p1r[7])*(Charge-14)/6;
        Par2r=p2r[7]+(p2r[8]-p2r[7])*(Charge-14)/6;

        Par1c=p1c[7]+(p1c[8]-p1c[7])*(Charge-14)/6;
        Par2c=p2c[7]+(p2c[8]-p2c[7])*(Charge-14)/6;
        Par3c=p3c[7]+(p3c[8]-p3c[7])*(Charge-14)/6;
        Par4c=p4c[7]+(p4c[8]-p4c[7])*(Charge-14)/6;
        Par5c=p5c[7]+(p5c[8]-p5c[7])*(Charge-14)/6;
        Par6c=p6c[7]+(p6c[8]-p6c[7])*(Charge-14)/6;
        Par7c=p7c[7]+(p7c[8]-p7c[7])*(Charge-14)/6;
    }
    else
    {
        Par1r=p1r[8]+(p1r[9]-p1r[8])*(Charge-20)/6;
        Par2r=p2r[8]+(p2r[9]-p2r[8])*(Charge-20)/6;

        Par1c=p1c[8]+(p1c[9]-p1c[8])*(Charge-20)/6;
        Par2c=p2c[8]+(p2c[9]-p2c[8])*(Charge-20)/6;
        Par3c=p3c[8]+(p3c[9]-p3c[8])*(Charge-20)/6;
        Par4c=p4c[8]+(p4c[9]-p4c[8])*(Charge-20)/6;
        Par5c=p5c[8]+(p5c[9]-p5c[8])*(Charge-20)/6;
        Par6c=p6c[8]+(p6c[9]-p6c[8])*(Charge-20)/6;
        Par7c=p7c[8]+(p7c[9]-p7c[8])*(Charge-20)/6;
    }
    DAmpL=DAmpL*(1+Par1r*TMath::Exp(-Par2r*Rigidity));
    if(Par4c>0.99999999999) Par4c=0.99999999999;
    if(Charge>=3 && Charge<=16)
    {
        PDFValue=Par4c*TMath::Exp(-(DAmpL-Par1c)/Par2c-Par3c*TMath::Exp(-(DAmpL-Par1c)/Par2c/Par3c)) + (1-Par4c)*TMath::Exp(-(DAmpL-Par5c)/Par6c-Par7c*TMath::Exp(-(DAmpL-Par5c)/Par6c/Par7c));
        PDFNormalization=Par4c*Par2c*TMath::Power(Par3c,1-Par3c)*TMath::Gamma(Par3c) + (1-Par4c)*Par6c*TMath::Power(Par7c,1-Par7c)*TMath::Gamma(Par7c);
        return PDFValue/PDFNormalization;
    }
    if(Charge>16)
    {
      double Step; //Used for removing lower tail for high charge delta ray PDF
      if(DAmpL>Par1c) Step=1;
      else Step=0;
      PDFValue=Par4c*TMath::Exp(-(DAmpL-Par1c)/Par2c-Par3c*TMath::Exp(-(DAmpL-Par1c)/Par2c/Par3c)) + Step*(1-Par4c)*TMath::Exp(-(DAmpL-Par5c)/Par6c-Par7c*TMath::Exp(-(DAmpL-Par5c)/Par6c/Par7c));
      PDFNormalization=Par4c*Par2c*TMath::Power(Par3c,1-Par3c)*TMath::Gamma(Par3c) + (1-Par4c)*Par6c*TMath::Power(Par7c,1-Par7c)*TMath::Gamma(Par7c)*TMath::Gamma(Par7c,Par7c*TMath::Exp(-(Par1c-Par5c)/Par6c/Par7c));
      return PDFValue/PDFNormalization;
    }

    //Charge and rigidity PDF for Z<3, fit points: 1, 2, also use fit at Z=3
    static const double p1cr[2][3]={{2.303,    2.1,    1.746},    {      8.306,   10.83,  12.27  }};
    static const double p2cr[2][3]={{32.04,    30,     26.34},    {      52.32,   58.03,  62.46  }};
    static const double p3cr[2][3]={{0.004065, 0.0037, 0.003456}, {   0.01169, 0.0284, 0.03558   }};
    static const double p4cr[2][3]={{0.4306,   0.46,   0.5749},   {     0.6811,  0.6556, 0.671   }};
    static double p5cr[2][3]={{0,        0,      0},              {          0,       0,      0  }};
    static const double p6cr[2][3]={{9.132,    8.45,   7.59},     {       39.74,   48.09,  52.44 }};
    static double p7cr[2][3]={{0,        0,      0},              {          0,       0,      0  }};


    for(int i=0;i<2;i++)
    {
        for(int j=0;j<3;j++)
        {
            p5cr[i][j]=2*p1cr[i][j];
            p7cr[i][j]=0.2;
        }
    }

    if(Charge<3 && Charge>=2)
    {
        if(Rigidity>=25)
        {
            Par1c=p1cr[1][2]+(p1c[0]-p1cr[1][2])*(Charge-2)/1;
            Par2c=p2cr[1][2]+(p2c[0]-p2cr[1][2])*(Charge-2)/1;
            Par3c=p3cr[1][2]+(p3c[0]-p3cr[1][2])*(Charge-2)/1;
            Par4c=p4cr[1][2]+(p4c[0]-p4cr[1][2])*(Charge-2)/1;
            Par5c=p5cr[1][2]+(p5c[0]-p5cr[1][2])*(Charge-2)/1;
            Par6c=p6cr[1][2]+(p6c[0]-p6cr[1][2])*(Charge-2)/1;
            Par7c=p7cr[1][2]+(p7c[0]-p7cr[1][2])*(Charge-2)/1;
        }
        else if(Rigidity>=8)
        {
            double a1,a2,a3,a4,a5,a6,a7;

            a1=p1cr[1][1]+(p1cr[1][2]-p1cr[1][1])*(Rigidity-8)/(25-8);
            a2=p2cr[1][1]+(p2cr[1][2]-p2cr[1][1])*(Rigidity-8)/(25-8);
            a3=p3cr[1][1]+(p3cr[1][2]-p3cr[1][1])*(Rigidity-8)/(25-8);
            a4=p4cr[1][1]+(p4cr[1][2]-p4cr[1][1])*(Rigidity-8)/(25-8);
            a5=p5cr[1][1]+(p5cr[1][2]-p5cr[1][1])*(Rigidity-8)/(25-8);
            a6=p6cr[1][1]+(p6cr[1][2]-p6cr[1][1])*(Rigidity-8)/(25-8);
            a7=p7cr[1][1]+(p7cr[1][2]-p7cr[1][1])*(Rigidity-8)/(25-8);

            Par1c=a1+(p1c[0]-a1)*(Charge-2)/1;
            Par2c=a2+(p2c[0]-a2)*(Charge-2)/1;
            Par3c=a3+(p3c[0]-a3)*(Charge-2)/1;
            Par4c=a4+(p4c[0]-a4)*(Charge-2)/1;
            Par5c=a5+(p5c[0]-a5)*(Charge-2)/1;
            Par6c=a6+(p6c[0]-a6)*(Charge-2)/1;
            Par7c=a7+(p7c[0]-a7)*(Charge-2)/1;
        }
        else if(Rigidity>=2)
        {
            double a1,a2,a3,a4,a5,a6,a7;

            a1=p1cr[1][0]+(p1cr[1][1]-p1cr[1][0])*(Rigidity-2)/(8-2);
            a2=p2cr[1][0]+(p2cr[1][1]-p2cr[1][0])*(Rigidity-2)/(8-2);
            a3=p3cr[1][0]+(p3cr[1][1]-p3cr[1][0])*(Rigidity-2)/(8-2);
            a4=p4cr[1][0]+(p4cr[1][1]-p4cr[1][0])*(Rigidity-2)/(8-2);
            a5=p5cr[1][0]+(p5cr[1][1]-p5cr[1][0])*(Rigidity-2)/(8-2);
            a6=p6cr[1][0]+(p6cr[1][1]-p6cr[1][0])*(Rigidity-2)/(8-2);
            a7=p7cr[1][0]+(p7cr[1][1]-p7cr[1][0])*(Rigidity-2)/(8-2);

            Par1c=a1+(p1c[0]-a1)*(Charge-2)/1;
            Par2c=a2+(p2c[0]-a2)*(Charge-2)/1;
            Par3c=a3+(p3c[0]-a3)*(Charge-2)/1;
            Par4c=a4+(p4c[0]-a4)*(Charge-2)/1;
            Par5c=a5+(p5c[0]-a5)*(Charge-2)/1;
            Par6c=a6+(p6c[0]-a6)*(Charge-2)/1;
            Par7c=a7+(p7c[0]-a7)*(Charge-2)/1;
        }
        else
        {
            Par1c=p1cr[1][0]+(p1c[0]-p1cr[1][0])*(Charge-2)/1;
            Par2c=p2cr[1][0]+(p2c[0]-p2cr[1][0])*(Charge-2)/1;
            Par3c=p3cr[1][0]+(p3c[0]-p3cr[1][0])*(Charge-2)/1;
            Par4c=p4cr[1][0]+(p4c[0]-p4cr[1][0])*(Charge-2)/1;
            Par5c=p5cr[1][0]+(p5c[0]-p5cr[1][0])*(Charge-2)/1;
            Par6c=p6cr[1][0]+(p6c[0]-p6cr[1][0])*(Charge-2)/1;
            Par7c=p7cr[1][0]+(p7c[0]-p7cr[1][0])*(Charge-2)/1;
        }

        PDFValue=Par4c*TMath::Exp(-(DAmpL-Par1c)/Par2c-Par3c*TMath::Exp(-(DAmpL-Par1c)/Par2c/Par3c)) + (1-Par4c)*TMath::Exp(-(DAmpL-Par5c)/Par6c-Par7c*TMath::Exp(-(DAmpL-Par5c)/Par6c/Par7c));
        PDFNormalization=Par4c*Par2c*TMath::Power(Par3c,1-Par3c)*TMath::Gamma(Par3c) + (1-Par4c)*Par6c*TMath::Power(Par7c,1-Par7c)*TMath::Gamma(Par7c);
        return PDFValue/PDFNormalization;
    }

    if(Charge<1) Charge=1;
    if(Rigidity>=25)
    {
        Par1c=p1cr[0][2]+(p1cr[1][2]-p1cr[0][2])*(Charge-1)/1;
        Par2c=p2cr[0][2]+(p2cr[1][2]-p2cr[0][2])*(Charge-1)/1;
        Par3c=p3cr[0][2]+(p3cr[1][2]-p3cr[0][2])*(Charge-1)/1;
        Par4c=p4cr[0][2]+(p4cr[1][2]-p4cr[0][2])*(Charge-1)/1;
        Par5c=p5cr[0][2]+(p5cr[1][2]-p5cr[0][2])*(Charge-1)/1;
        Par6c=p6cr[0][2]+(p6cr[1][2]-p6cr[0][2])*(Charge-1)/1;
        Par7c=p7cr[0][2]+(p7cr[1][2]-p7cr[0][2])*(Charge-1)/1;
    }
    else if(Rigidity>=8)
    {
        double a1,a2,a3,a4,a5,a6,a7;
        double b1,b2,b3,b4,b5,b6,b7;

        a1=p1cr[0][1]+(p1cr[0][2]-p1cr[0][1])*(Rigidity-8)/(25-8);
        a2=p2cr[0][1]+(p2cr[0][2]-p2cr[0][1])*(Rigidity-8)/(25-8);
        a3=p3cr[0][1]+(p3cr[0][2]-p3cr[0][1])*(Rigidity-8)/(25-8);
        a4=p4cr[0][1]+(p4cr[0][2]-p4cr[0][1])*(Rigidity-8)/(25-8);
        a5=p5cr[0][1]+(p5cr[0][2]-p5cr[0][1])*(Rigidity-8)/(25-8);
        a6=p6cr[0][1]+(p6cr[0][2]-p6cr[0][1])*(Rigidity-8)/(25-8);
        a7=p7cr[0][1]+(p7cr[0][2]-p7cr[0][1])*(Rigidity-8)/(25-8);

        b1=p1cr[1][1]+(p1cr[1][2]-p1cr[1][2])*(Rigidity-8)/(25-8);
        b2=p2cr[1][1]+(p2cr[1][2]-p2cr[1][2])*(Rigidity-8)/(25-8);
        b3=p3cr[1][1]+(p3cr[1][2]-p3cr[1][2])*(Rigidity-8)/(25-8);
        b4=p4cr[1][1]+(p4cr[1][2]-p4cr[1][2])*(Rigidity-8)/(25-8);
        b5=p5cr[1][1]+(p5cr[1][2]-p5cr[1][2])*(Rigidity-8)/(25-8);
        b6=p6cr[1][1]+(p6cr[1][2]-p6cr[1][2])*(Rigidity-8)/(25-8);
        b7=p7cr[1][1]+(p7cr[1][2]-p7cr[1][2])*(Rigidity-8)/(25-8);

        Par1c=a1+(b1-a1)*(Charge-1)/1;
        Par2c=a2+(b2-a2)*(Charge-1)/1;
        Par3c=a3+(b3-a3)*(Charge-1)/1;
        Par4c=a4+(b4-a4)*(Charge-1)/1;
        Par5c=a5+(b5-a5)*(Charge-1)/1;
        Par6c=a6+(b6-a6)*(Charge-1)/1;
        Par7c=a7+(b7-a7)*(Charge-1)/1;
    }
    else if(Rigidity>=2)
    {
        double a1,a2,a3,a4,a5,a6,a7;
        double b1,b2,b3,b4,b5,b6,b7;

        a1=p1cr[0][0]+(p1cr[0][1]-p1cr[0][0])*(Rigidity-2)/(8-2);
        a2=p2cr[0][0]+(p2cr[0][1]-p2cr[0][0])*(Rigidity-2)/(8-2);
        a3=p3cr[0][0]+(p3cr[0][1]-p3cr[0][0])*(Rigidity-2)/(8-2);
        a4=p4cr[0][0]+(p4cr[0][1]-p4cr[0][0])*(Rigidity-2)/(8-2);
        a5=p5cr[0][0]+(p5cr[0][1]-p5cr[0][0])*(Rigidity-2)/(8-2);
        a6=p6cr[0][0]+(p6cr[0][1]-p6cr[0][0])*(Rigidity-2)/(8-2);
        a7=p7cr[0][0]+(p7cr[0][1]-p7cr[0][0])*(Rigidity-2)/(8-2);

        b1=p1cr[1][0]+(p1cr[1][1]-p1cr[1][0])*(Rigidity-2)/(8-2);
        b2=p2cr[1][0]+(p2cr[1][1]-p2cr[1][0])*(Rigidity-2)/(8-2);
        b3=p3cr[1][0]+(p3cr[1][1]-p3cr[1][0])*(Rigidity-2)/(8-2);
        b4=p4cr[1][0]+(p4cr[1][1]-p4cr[1][0])*(Rigidity-2)/(8-2);
        b5=p5cr[1][0]+(p5cr[1][1]-p5cr[1][0])*(Rigidity-2)/(8-2);
        b6=p6cr[1][0]+(p6cr[1][1]-p6cr[1][0])*(Rigidity-2)/(8-2);
        b7=p7cr[1][0]+(p7cr[1][1]-p7cr[1][0])*(Rigidity-2)/(8-2);

        Par1c=a1+(b1-a1)*(Charge-1)/1;
        Par2c=a2+(b2-a2)*(Charge-1)/1;
        Par3c=a3+(b3-a3)*(Charge-1)/1;
        Par4c=a4+(b4-a4)*(Charge-1)/1;
        Par5c=a5+(b5-a5)*(Charge-1)/1;
        Par6c=a6+(b6-a6)*(Charge-1)/1;
        Par7c=a7+(b7-a7)*(Charge-1)/1;
    }
    else
    {
        Par1c=p1cr[0][0]+(p1cr[1][0]-p1cr[0][0])*(Charge-1)/1;
        Par2c=p2cr[0][0]+(p2cr[1][0]-p2cr[0][0])*(Charge-1)/1;
        Par3c=p3cr[0][0]+(p3cr[1][0]-p3cr[0][0])*(Charge-1)/1;
        Par4c=p4cr[0][0]+(p4cr[1][0]-p4cr[0][0])*(Charge-1)/1;
        Par5c=p5cr[0][0]+(p5cr[1][0]-p5cr[0][0])*(Charge-1)/1;
        Par6c=p6cr[0][0]+(p6cr[1][0]-p6cr[0][0])*(Charge-1)/1;
        Par7c=p7cr[0][0]+(p7cr[1][0]-p7cr[0][0])*(Charge-1)/1;
    }

    if(DAmpL>5) PDFValue=Par4c*TMath::Exp(-(DAmpL-Par1c)/Par2c-Par3c*TMath::Exp(-(DAmpL-Par1c)/Par2c/Par3c)) + (1-Par4c)*TMath::Exp(-(DAmpL-Par5c)/Par6c-Par7c*TMath::Exp(-(DAmpL-Par5c)/Par6c/Par7c));
    else PDFValue=(Par4c*Par2c*TMath::Power(Par3c,1-Par3c)*TMath::Gamma(Par3c))*(1-TMath::Gamma(Par3c,Par3c*TMath::Exp(-(5-Par1c)/Par2c/Par3c))) + (1-Par4c)*Par6c*TMath::Power(Par7c,1-Par7c)*TMath::Gamma(Par7c)*(1-TMath::Gamma(Par7c,Par7c*TMath::Exp(-(5-Par5c)/Par6c/Par7c)));
    PDFNormalization=Par4c*Par2c*TMath::Power(Par3c,1-Par3c)*TMath::Gamma(Par3c) + (1-Par4c)*Par6c*TMath::Power(Par7c,1-Par7c)*TMath::Gamma(Par7c);
    return PDFValue/PDFNormalization;
}





//////////////////////////
//END: Added by Wei Sun
//////////////////////////

