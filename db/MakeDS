# Make AMS + DB exe file
#
# V0.0     May 1996. A.Klimentov
# 
# V1.25    Sep 12, 1996. ak. cxxfix, etc
# AIX/OSF1 Sep 18, 1996. ak/vs
# Make dependencies from ../include/*.h  Oct 21, 1996. ak.
#
# Last Edit : Oct 21, 1996. ak
#
#

#
SHELL=/bin/sh
#
ifeq  "$(shell uname)"  "AIX"
BIN_DB          = ../db/bin/aix/
BIN             = ../bin/aix
EXE             = ../exe/aix/

CFLAGS= -D__AMSDEBUG__  -D__BATCH__ -D__DB__ 
CCFLAGS = -g
FFLAGS=   -g -I../include -qextname -d
DFLAGS=  -D__AMSDEBUG__  -g   -I/usr/include -I/usr/lpp/xlC/include -I../include -I../include/stl
GLIBS= -g -bloadmap:map -lxlf90 -lxlf -L/cern/old/lib  -lgeant321 -lmathlib\
        -lpacklib -lkernlib  -L/afs/cern.ch/asis/packages/licensed/nag-mark16/rs_aix32/nagfl16df -lnag


CC=xlC
FF=xlf
LD=xlC
TIMEL=../bin/aix/timel.o

include config.user_ibmrs6000

INC_OODDL      = /usr/lpp/xlC/include

endif

ifeq  "$(shell uname)"  "OSF1"
BIN_DB          = ../db/bin/osf1/
BIN             = ../bin/osf1
EXE             = ../exe/osf1/

CFLAGS= -D__AMSDEBUG__  -D__BATCH__ -D__ALPHA__ -D__APOOL__ -D__DB__ 
CCFLAGS = -define_templates -g

FFLAGS=   -g -I../include  -d -static -nofor_main -convert big_endian
DFLAGS=  -D__AMSDEBUG__  -g   -I/usr/include  -I../include -I../include/stl \
         -I/usr/include/cxx

GLIBS = -g -lUfor   -lfor -lFutil -lots -lm -L/cern/old/lib  -lgeant321 -lmathlib -lpacklib -lkernlib  -L/afs/cern.ch/asis/packages/licensed/nag-mark16/alpha_osf32c/nagfl16df -lnag

CC=cxx
FF=f77
LD=cxx
TIMEL=../bin/osf1/timel.o

include config.user_alphaosf1

endif


#########################
#                       #
# Configuration Section #
#                       #
#########################

#include config.user
include config.$(ARCH)
#########################
#                       #
# Program Executables   #
#                       #
#########################

LMS	= $(EXE)deleteSetup

#########################
#                       #
# Schema Files          #
#                       #
#########################

DDL_SRC         = ../db/

#########################
#                       #
# Program Source        #
#                       #
#########################

#########################
#                       #
# Program Directories   #
#                       #
#########################

INC_DIR		= $(INSTALL_DIR)/$(ARCH)/include
LIB_DIR		= $(INSTALL_DIR)/$(ARCH)/lib
BIN_DIR		= $(INSTALL_DIR)/$(ARCH)/bin

INC_AMS         = ../include
INC_STL         = ../include/stl
INC_DDL         = ../db 

#########################
#                       #
# Objectivity Tools	#
#                       #
#########################

OODDL		= $(BIN_DIR)/ooddlx
OONEWFD		= $(BIN_DIR)/oonewfd
OODELETEFD	= $(BIN_DIR)/oodeletefd

#########################
#                       #
# Compile Rules         #
#                       #
#########################

INCLUDES = -I$(INC_DIR) -I$(INC_DDL) -I$(INC_AMS) -I$(INC_STL)

.SUFFIXES: .C .ddl 

#.C.o:
#	$(C++) $(C_FLAGS) $(CFLAGS) $(INCLUDES) -c $*.C -o $(BIN_DB)$*.o


#########################
#                       #
# Object Files          #
#                       #
#########################
LMS_OBJS = $(BIN_DB)A_LMS.o $(BIN_DB)mcctcclusterD_ddl.o $(BIN_DB)A_LMSAdd.o \
           $(BIN_DB)mceventD.o $(BIN_DB)A_LMSDelete.o $(BIN_DB)mceventD_ddl.o \
           $(BIN_DB)A_LMSFill.o $(BIN_DB)mceventgD.o $(BIN_DB)A_LMSMenu.o   \
           $(BIN_DB)mceventgD_ddl.o $(BIN_DB)A_LMSPrint.o  \
           $(BIN_DB)mctofclusterD.o $(BIN_DB)amsdbcD.o  \
           $(BIN_DB)mctofclusterV.o $(BIN_DB)amsdbcD_ddl.o \
           $(BIN_DB)mctofclusterV_ddl.o $(BIN_DB)chargeD.o \
           $(BIN_DB)ooSession.o $(BIN_DB)chargeD_ddl.o  $(BIN_DB)ooStats.o \
           $(BIN_DB)commonsD.o  $(BIN_DB)particleD.o $(BIN_DB)commonsD_ddl.o \
           $(BIN_DB)particleD_ddl.o $(BIN_DB)ctcdbcD.o  \
           $(BIN_DB)deleteSetup.o \
           $(BIN_DB)ctcdbcD_ddl.o $(BIN_DB)tbeta.o $(BIN_DB)ctcrecD.o  \
           $(BIN_DB)tbeta_ddl.o $(BIN_DB)ctcrecD_ddl.o  $(BIN_DB)tcluster.o \
           $(BIN_DB)tcluster_ddl.o \
           $(BIN_DB)timeidD.o $(BIN_DB)eventD.o  $(BIN_DB)timeidD_ddl.o \
           $(BIN_DB)eventD_ddl.o   $(BIN_DB)timeid_sub.o $(BIN_DB)gmatD.o \
           $(BIN_DB)tmccluster.o $(BIN_DB)gmatD_ddl.o  $(BIN_DB)tmcclusterV.o \
           $(BIN_DB)gtmedD.o $(BIN_DB)tmcclusterV_ddl.o $(BIN_DB)gtmedD_ddl.o \
           $(BIN_DB)gvolumeD.o  $(BIN_DB)tofdbcD.o \
           $(BIN_DB)gvolumeD_ddl.o  $(BIN_DB)tofdbcD_ddl.o $(BIN_DB)list.o  \
           $(BIN_DB)tofrecD.o $(BIN_DB)list_ddl.o $(BIN_DB)tofrecD_ddl.o \
           $(BIN_DB)trrechit.o $(BIN_DB)mcanticlusterD.o \
           $(BIN_DB)trrechit_ddl.o $(BIN_DB)mcanticlusterD_ddl.o  \
           $(BIN_DB)ttrack.o $(BIN_DB)mcctcclusterD.o  $(BIN_DB)ttrack_ddl.o

DB_OBJS	= $(LMS_OBJS)

#########################
#                       #
# Link Rules            #
#                       #
#########################

OBJECT_LIBS	= $(LIB_DIR)/liboo.a
SRC             = ../CC
GEANT_OBJS= $(BIN)/commons.o $(BIN)/gvolume.o  $(BIN)/id.o $(BIN)/node.o $(BIN)/snode.o $(BIN)/cern.o $(BIN)/amsdbc.o $(BIN)/gsen.o  $(BIN)/mtx.o $(BIN)/point.o $(BIN)/amstkshc++.o $(BIN)/sgif.o $(BIN)/upool.o $(BIN)/gmat.o $(BIN)/amsgobj.o $(BIN)/amsgeom.o  $(BIN)/mceventg.o $(BIN)/tkmccl.o $(BIN)/rnormx.o  $(BIN)/trid.o $(BIN)/link.o $(BIN)/trrec.o $(BIN)/uzstat.o $(BIN)/tptcir.o $(BIN)/trafit.o $(BIN)/tcircf.o $(BIN)/tszfit.o $(BIN)/txyfit.o  $(BIN)/job.o $(BIN)/event.o $(BIN)/cont.o $(BIN)/trrawcluster.o $(BIN)/mccluster.o $(BIN)/rndm.o $(BIN)/tofrec.o $(BIN)/tofsim.o $(BIN)/beta.o $(BIN)/charge.o $(BIN)/particle.o $(BIN)/apool.o $(BIN)/tofdbc.o $(BIN)/ctcrec.o $(BIN)/ctcdbc.o $(BIN)/tofcalib.o $(BIN)/timeid.o $(BIN)/io.o $(BIN)/trcalib.o $(BIN)/mtx2.o $(BIN)/e04ccf.o 


CERN_LIBS       = -L/cern/pro/lib  -lgeant321 -lmathlib -lpacklib -lkernlib

all:	$(LMS)

$(LMS): $(DB_OBJS) 
	$(LD) $(LD_FLAGS) -o $(LMS) $(DB_OBJS) $(GEANT_OBJS) $(OBJECT_LIBS) \
        $(GLIBS)


#########################
#                       #
# Dependencies		#
#                       #
#########################


 $(BIN_DB)deleteSetup.o:   deleteSetup.C db_comm.h A_LMS.h list.ddl list.C
	$(C++) $(C_FLAGS) $(CFLAGS) $(INCLUDES) $(CCFLAGS) -c \
          ../db/deleteSetup.C -o $(BIN_DB)deleteSetup.o
